<!doctype html><html class="theme-next mist use-motion" lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css"><meta name="keywords" content="Hexo, NexT"><link rel="alternate" href="/atom.xml" title="Abracdabra" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0"><meta name="description" content="Ewan&apos;s IT Blog"><meta property="og:type" content="website"><meta property="og:title" content="Abracdabra"><meta property="og:url" content="http://yoursite.com/page/14/index.html"><meta property="og:site_name" content="Abracdabra"><meta property="og:description" content="Ewan&apos;s IT Blog"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Abracdabra"><meta name="twitter:description" content="Ewan&apos;s IT Blog"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",sidebar:{position:"left",display:"post"},fancybox:!0,motion:!0,duoshuo:{userId:"0",author:"Author"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://yoursite.com/page/14/"><title>Abracdabra</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="en"><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?dc405a79ad500922134d14cdf288f646";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div class="container one-collumn sidebar-position-left page-home"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Abracdabra</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">Do it yourself</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>Home</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>Categories</a></li><li class="menu-item menu-item-about"><a href="/about" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>About</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>Archives</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>Tags</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br>Sitemap</a></li><li class="menu-item menu-item-commonweal"><a href="/404.html" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br>公益404</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>Search</a></li></ul><div class="site-search"><div class="popup"><span class="search-icon fa fa-search"></span> <input type="text" id="local-search-input"><div id="local-search-result"></div><span class="popup-btn-close">close</span></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><section id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/28/Python-data-analysis-Learning-note-ch05/"><span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Ewan Li"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Abracdabra"><span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject"><img style="display:none" itemprop="url image" alt="Abracdabra" src=""></span></span><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/2017/02/28/Python-data-analysis-Learning-note-ch05/" itemprop="url">Python data analysis Learning note ch05</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-28T18:05:03+08:00">2017-02-28 </time></span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/2017/02/28/Python-data-analysis-Learning-note-ch05/#comments" itemprop="discussionUrl"><span class="post-comments-count ds-thread-count" data-thread-key="2017/02/28/Python-data-analysis-Learning-note-ch05/" itemprop="commentCount"></span> </a></span><span id="/2017/02/28/Python-data-analysis-Learning-note-ch05/" class="leancloud_visitors" data-flag-title="Python data analysis Learning note ch05"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">Visitors </span><span class="leancloud-visitors-count"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="pandas入门"><a href="#pandas入门" class="headerlink" title="pandas入门"></a>pandas入门</h1><p>按照以下约定引用相关package</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series, DataFrame</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> division</div><div class="line"><span class="keyword">from</span> numpy.random <span class="keyword">import</span> randn</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line">np.random.seed(<span class="number">12345</span>)</div><div class="line">plt.rc(<span class="string">'figure'</span>, figsize=(<span class="number">10</span>, <span class="number">6</span>))</div><div class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series, DataFrame</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line">np.set_printoptions(precision=<span class="number">4</span>)</div><div class="line"><span class="keyword">from</span> IPython.core.interactiveshell <span class="keyword">import</span> InteractiveShell</div><div class="line">InteractiveShell.ast_node_interactivity = <span class="string">"all"</span></div></pre></td></tr></table></figure><h2 id="pandas数据结构介绍"><a href="#pandas数据结构介绍" class="headerlink" title="pandas数据结构介绍"></a>pandas数据结构介绍</h2><h3 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h3><p>Series是一种类似于一维数组的对象，由一组数据以及一组与之相关的数据标签（类似于字典的键）组成，所以可以看成是一个<strong>有序</strong>的字典</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">obj = Series([<span class="number">4</span>, <span class="number">7</span>, <span class="number">-5</span>, <span class="number">3</span>])</div><div class="line">obj</div></pre></td></tr></table></figure><pre><code>0    4
1    7
2   -5
3    3
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">obj.values</div><div class="line">obj.index</div></pre></td></tr></table></figure><pre><code>array([ 4,  7, -5,  3], dtype=int64)






RangeIndex(start=0, stop=4, step=1)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">obj2 = Series([<span class="number">4</span>, <span class="number">7</span>, <span class="number">-5</span>, <span class="number">3</span>], index=[<span class="string">'d'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'c'</span>])</div><div class="line">obj2</div></pre></td></tr></table></figure><pre><code>d    4
b    7
a   -5
c    3
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj2.index</div></pre></td></tr></table></figure><pre><code>Index([&#39;d&#39;, &#39;b&#39;, &#39;a&#39;, &#39;c&#39;], dtype=&#39;object&#39;)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj2[<span class="string">'a'</span>]</div></pre></td></tr></table></figure><pre><code>-5
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">obj2[<span class="string">'d'</span>] = <span class="number">6</span></div><div class="line">obj2[[<span class="string">'c'</span>, <span class="string">'a'</span>, <span class="string">'d'</span>]]</div></pre></td></tr></table></figure><pre><code>c    3
a   -5
d    6
dtype: int64
</code></pre><p>各种Numpy运算都是作用在数据上，同时索引与数据的链接会一直保持</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj2[obj2 &gt; <span class="number">0</span>]</div></pre></td></tr></table></figure><pre><code>d    6
b    7
c    3
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj2 * <span class="number">2</span></div></pre></td></tr></table></figure><pre><code>d    12
b    14
a   -10
c     6
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">np.exp(obj2)</div></pre></td></tr></table></figure><pre><code>d     403.428793
b    1096.633158
a       0.006738
c      20.085537
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">'b'</span> <span class="keyword">in</span> obj2</div></pre></td></tr></table></figure><pre><code>True
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">'e'</span> <span class="keyword">in</span> obj2</div></pre></td></tr></table></figure><pre><code>False
</code></pre><p>因此可以直接根据Numpy的Dict来创建Series</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sdata = &#123;<span class="string">'Ohio'</span>: <span class="number">35000</span>, <span class="string">'Texas'</span>: <span class="number">71000</span>, <span class="string">'Oregon'</span>: <span class="number">16000</span>, <span class="string">'Utah'</span>: <span class="number">5000</span>&#125;</div><div class="line">obj3 = Series(sdata)</div><div class="line">obj3</div></pre></td></tr></table></figure><pre><code>Ohio      35000
Oregon    16000
Texas     71000
Utah       5000
dtype: int64
</code></pre><p>如果传入了index参数的话，那么就会与传入的Dict做键匹配，没有匹配上的就设为NaN</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">states = [<span class="string">'California'</span>, <span class="string">'Ohio'</span>, <span class="string">'Oregon'</span>, <span class="string">'Texas'</span>]</div><div class="line">obj4 = Series(sdata, index=states)</div><div class="line">obj4</div></pre></td></tr></table></figure><pre><code>California        NaN
Ohio          35000.0
Oregon        16000.0
Texas         71000.0
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pd.isnull(obj4)</div></pre></td></tr></table></figure><pre><code>California     True
Ohio          False
Oregon        False
Texas         False
dtype: bool
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pd.notnull(obj4)</div></pre></td></tr></table></figure><pre><code>California    False
Ohio           True
Oregon         True
Texas          True
dtype: bool
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj4.isnull()</div></pre></td></tr></table></figure><pre><code>California     True
Ohio          False
Oregon        False
Texas         False
dtype: bool
</code></pre><p>Series有一个非常重要的数据对齐的功能</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj3</div></pre></td></tr></table></figure><pre><code>Ohio      35000
Oregon    16000
Texas     71000
Utah       5000
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj4</div></pre></td></tr></table></figure><pre><code>California        NaN
Ohio          35000.0
Oregon        16000.0
Texas         71000.0
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj3 + obj4</div></pre></td></tr></table></figure><pre><code>California         NaN
Ohio           70000.0
Oregon         32000.0
Texas         142000.0
Utah               NaN
dtype: float64
</code></pre><p>Series本身以及其索引都有一个叫做name的属性，这个属性十分重要，以后很多高级功能都会用到</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">obj4.name = <span class="string">'population'</span></div><div class="line">obj4.index.name = <span class="string">'state'</span></div><div class="line">obj4</div></pre></td></tr></table></figure><pre><code>state
California        NaN
Ohio          35000.0
Oregon        16000.0
Texas         71000.0
Name: population, dtype: float64
</code></pre><p>可以通过直接赋值的方式修改index属性</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">obj.index = [<span class="string">'Bob'</span>, <span class="string">'Steve'</span>, <span class="string">'Jeff'</span>, <span class="string">'Ryan'</span>]</div><div class="line">obj</div></pre></td></tr></table></figure><pre><code>Bob      4
Steve    7
Jeff    -5
Ryan     3
dtype: int64
</code></pre><h3 id="DataFrame"><a href="#DataFrame" class="headerlink" title="DataFrame"></a>DataFrame</h3><p>DataFrame是一个表格型的数据结构，可以看成由Series组成的字典，只不过这些Series共用一套索引</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">data = &#123;<span class="string">'state'</span>: [<span class="string">'Ohio'</span>, <span class="string">'Ohio'</span>, <span class="string">'Ohio'</span>, <span class="string">'Nevada'</span>, <span class="string">'Nevada'</span>],</div><div class="line">        <span class="string">'year'</span>: [<span class="number">2000</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2001</span>, <span class="number">2002</span>],</div><div class="line">        <span class="string">'pop'</span>: [<span class="number">1.5</span>, <span class="number">1.7</span>, <span class="number">3.6</span>, <span class="number">2.4</span>, <span class="number">2.9</span>]&#125;</div><div class="line">frame = DataFrame(data)</div></pre></td></tr></table></figure><p>数据会被排序</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>pop</th><th>state</th><th>year</th></tr></thead><tbody><tr><th>0</th><td>1.5</td><td>Ohio</td><td>2000</td></tr><tr><th>1</th><td>1.7</td><td>Ohio</td><td>2001</td></tr><tr><th>2</th><td>3.6</td><td>Ohio</td><td>2002</td></tr><tr><th>3</th><td>2.4</td><td>Nevada</td><td>2001</td></tr><tr><th>4</th><td>2.9</td><td>Nevada</td><td>2002</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">DataFrame(data, columns=[<span class="string">'year'</span>, <span class="string">'state'</span>, <span class="string">'pop'</span>])</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>year</th><th>state</th><th>pop</th></tr></thead><tbody><tr><th>0</th><td>2000</td><td>Ohio</td><td>1.5</td></tr><tr><th>1</th><td>2001</td><td>Ohio</td><td>1.7</td></tr><tr><th>2</th><td>2002</td><td>Ohio</td><td>3.6</td></tr><tr><th>3</th><td>2001</td><td>Nevada</td><td>2.4</td></tr><tr><th>4</th><td>2002</td><td>Nevada</td><td>2.9</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">frame2 = DataFrame(data, columns=[<span class="string">'year'</span>, <span class="string">'state'</span>, <span class="string">'pop'</span>, <span class="string">'debt'</span>],</div><div class="line">                   index=[<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>, <span class="string">'four'</span>, <span class="string">'five'</span>])</div><div class="line">frame2</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>year</th><th>state</th><th>pop</th><th>debt</th></tr></thead><tbody><tr><th>one</th><td>2000</td><td>Ohio</td><td>1.5</td><td>NaN</td></tr><tr><th>two</th><td>2001</td><td>Ohio</td><td>1.7</td><td>NaN</td></tr><tr><th>three</th><td>2002</td><td>Ohio</td><td>3.6</td><td>NaN</td></tr><tr><th>four</th><td>2001</td><td>Nevada</td><td>2.4</td><td>NaN</td></tr><tr><th>five</th><td>2002</td><td>Nevada</td><td>2.9</td><td>NaN</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame2.columns</div></pre></td></tr></table></figure><pre><code>Index([&#39;year&#39;, &#39;state&#39;, &#39;pop&#39;, &#39;debt&#39;], dtype=&#39;object&#39;)
</code></pre><p>DataFrame每一个Key对应的Value都是一个Series</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame2[<span class="string">'state'</span>]</div></pre></td></tr></table></figure><pre><code>one        Ohio
two        Ohio
three      Ohio
four     Nevada
five     Nevada
Name: state, dtype: object
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame2.year</div></pre></td></tr></table></figure><pre><code>one      2000
two      2001
three    2002
four     2001
five     2002
Name: year, dtype: int64
</code></pre><p>注意到name属性也已经被设置好了</p><p>ix相当于一个行索引？</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame2.ix[<span class="string">'three'</span>]</div></pre></td></tr></table></figure><pre><code>year     2002
state    Ohio
pop       3.6
debt      NaN
Name: three, dtype: object
</code></pre><p>可以利用Numpy的广播功能</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">frame2[<span class="string">'debt'</span>] = <span class="number">16.5</span></div><div class="line">frame2</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>year</th><th>state</th><th>pop</th><th>debt</th></tr></thead><tbody><tr><th>one</th><td>2000</td><td>Ohio</td><td>1.5</td><td>16.5</td></tr><tr><th>two</th><td>2001</td><td>Ohio</td><td>1.7</td><td>16.5</td></tr><tr><th>three</th><td>2002</td><td>Ohio</td><td>3.6</td><td>16.5</td></tr><tr><th>four</th><td>2001</td><td>Nevada</td><td>2.4</td><td>16.5</td></tr><tr><th>five</th><td>2002</td><td>Nevada</td><td>2.9</td><td>16.5</td></tr></tbody></table></div><p>也可以赋值一个列表，但是长度必须匹配</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">frame2[<span class="string">'debt'</span>] = np.arange(<span class="number">5.</span>)</div><div class="line">frame2</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>year</th><th>state</th><th>pop</th><th>debt</th></tr></thead><tbody><tr><th>one</th><td>2000</td><td>Ohio</td><td>1.5</td><td>0.0</td></tr><tr><th>two</th><td>2001</td><td>Ohio</td><td>1.7</td><td>1.0</td></tr><tr><th>three</th><td>2002</td><td>Ohio</td><td>3.6</td><td>2.0</td></tr><tr><th>four</th><td>2001</td><td>Nevada</td><td>2.4</td><td>3.0</td></tr><tr><th>five</th><td>2002</td><td>Nevada</td><td>2.9</td><td>4.0</td></tr></tbody></table></div><p>如果是赋值一个Series，则会匹配上索引，没有匹配上的就是置为NaN</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">val = Series([<span class="number">-1.2</span>, <span class="number">-1.5</span>, <span class="number">-1.7</span>], index=[<span class="string">'two'</span>, <span class="string">'four'</span>, <span class="string">'five'</span>])</div><div class="line">frame2[<span class="string">'debt'</span>] = val</div><div class="line">frame2</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>year</th><th>state</th><th>pop</th><th>debt</th></tr></thead><tbody><tr><th>one</th><td>2000</td><td>Ohio</td><td>1.5</td><td>NaN</td></tr><tr><th>two</th><td>2001</td><td>Ohio</td><td>1.7</td><td>-1.2</td></tr><tr><th>three</th><td>2002</td><td>Ohio</td><td>3.6</td><td>NaN</td></tr><tr><th>four</th><td>2001</td><td>Nevada</td><td>2.4</td><td>-1.5</td></tr><tr><th>five</th><td>2002</td><td>Nevada</td><td>2.9</td><td>-1.7</td></tr></tbody></table></div><p>也可以进行逻辑操作</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">frame2[<span class="string">'eastern'</span>] = frame2.state == <span class="string">'Ohio'</span></div><div class="line">frame2</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>year</th><th>state</th><th>pop</th><th>debt</th><th>eastern</th></tr></thead><tbody><tr><th>one</th><td>2000</td><td>Ohio</td><td>1.5</td><td>NaN</td><td>True</td></tr><tr><th>two</th><td>2001</td><td>Ohio</td><td>1.7</td><td>-1.2</td><td>True</td></tr><tr><th>three</th><td>2002</td><td>Ohio</td><td>3.6</td><td>NaN</td><td>True</td></tr><tr><th>four</th><td>2001</td><td>Nevada</td><td>2.4</td><td>-1.5</td><td>False</td></tr><tr><th>five</th><td>2002</td><td>Nevada</td><td>2.9</td><td>-1.7</td><td>False</td></tr></tbody></table></div><p>del用于删除一列</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">del</span> frame2[<span class="string">'eastern'</span>]</div><div class="line">frame2.columns</div></pre></td></tr></table></figure><pre><code>Index([&#39;year&#39;, &#39;state&#39;, &#39;pop&#39;, &#39;debt&#39;], dtype=&#39;object&#39;)
</code></pre><p><strong>只要是通过索引方式进行的操作，都是直接在原数据上进行的操作，不是一个副本</strong></p><p>嵌套的字典也可直接生成DataFrame，只不过内层的键被当作index，外层的键被当作colums</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pop = &#123;<span class="string">'Nevada'</span>: &#123;<span class="number">2001</span>: <span class="number">2.4</span>, <span class="number">2002</span>: <span class="number">2.9</span>&#125;,</div><div class="line">       <span class="string">'Ohio'</span>: &#123;<span class="number">2000</span>: <span class="number">1.5</span>, <span class="number">2001</span>: <span class="number">1.7</span>, <span class="number">2002</span>: <span class="number">3.6</span>&#125;&#125;</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">frame3 = DataFrame(pop)</div><div class="line">frame3</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Nevada</th><th>Ohio</th></tr></thead><tbody><tr><th>2000</th><td>NaN</td><td>1.5</td></tr><tr><th>2001</th><td>2.4</td><td>1.7</td></tr><tr><th>2002</th><td>2.9</td><td>3.6</td></tr></tbody></table></div><p>同样可以进行转置，这样的话index和column就会互换</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame3.T</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>2000</th><th>2001</th><th>2002</th></tr></thead><tbody><tr><th>Nevada</th><td>NaN</td><td>2.4</td><td>2.9</td></tr><tr><th>Ohio</th><td>1.5</td><td>1.7</td><td>3.6</td></tr></tbody></table></div><p>显式地指定索引，不匹配的会置为NaN</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">DataFrame(pop, index=[<span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2003</span>])</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Nevada</th><th>Ohio</th></tr></thead><tbody><tr><th>2001</th><td>2.4</td><td>1.7</td></tr><tr><th>2002</th><td>2.9</td><td>3.6</td></tr><tr><th>2003</th><td>NaN</td><td>NaN</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame3</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Nevada</th><th>Ohio</th></tr></thead><tbody><tr><th>2000</th><td>NaN</td><td>1.5</td></tr><tr><th>2001</th><td>2.4</td><td>1.7</td></tr><tr><th>2002</th><td>2.9</td><td>3.6</td></tr></tbody></table></div><p>还可以这样构建</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pdata = &#123;<span class="string">'Ohio'</span>: frame3[<span class="string">'Ohio'</span>][:<span class="number">-1</span>],</div><div class="line">         <span class="string">'Nevada'</span>: frame3[<span class="string">'Nevada'</span>][:<span class="number">2</span>]&#125;</div><div class="line">DataFrame(pdata)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Nevada</th><th>Ohio</th></tr></thead><tbody><tr><th>2000</th><td>NaN</td><td>1.5</td></tr><tr><th>2001</th><td>2.4</td><td>1.7</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame3</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Nevada</th><th>Ohio</th></tr></thead><tbody><tr><th>2000</th><td>NaN</td><td>1.5</td></tr><tr><th>2001</th><td>2.4</td><td>1.7</td></tr><tr><th>2002</th><td>2.9</td><td>3.6</td></tr></tbody></table></div><p>name属性也会在表格中显示出来</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">frame3.index.name = <span class="string">'year'</span>; frame3.columns.name = <span class="string">'state'</span></div><div class="line">frame3</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th>state</th><th>Nevada</th><th>Ohio</th></tr><tr><th>year</th><th></th><th></th></tr></thead><tbody><tr><th>2000</th><td>NaN</td><td>1.5</td></tr><tr><th>2001</th><td>2.4</td><td>1.7</td></tr><tr><th>2002</th><td>2.9</td><td>3.6</td></tr></tbody></table></div><p>values方法只返回数据，不返回index以及key</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame3.values</div></pre></td></tr></table></figure><pre><code>array([[ nan,  1.5],
       [ 2.4,  1.7],
       [ 2.9,  3.6]])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame2</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>year</th><th>state</th><th>pop</th><th>debt</th></tr></thead><tbody><tr><th>one</th><td>2000</td><td>Ohio</td><td>1.5</td><td>NaN</td></tr><tr><th>two</th><td>2001</td><td>Ohio</td><td>1.7</td><td>-1.2</td></tr><tr><th>three</th><td>2002</td><td>Ohio</td><td>3.6</td><td>NaN</td></tr><tr><th>four</th><td>2001</td><td>Nevada</td><td>2.4</td><td>-1.5</td></tr><tr><th>five</th><td>2002</td><td>Nevada</td><td>2.9</td><td>-1.7</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame2.values</div></pre></td></tr></table></figure><pre><code>array([[2000, &#39;Ohio&#39;, 1.5, nan],
       [2001, &#39;Ohio&#39;, 1.7, -1.2],
       [2002, &#39;Ohio&#39;, 3.6, nan],
       [2001, &#39;Nevada&#39;, 2.4, -1.5],
       [2002, &#39;Nevada&#39;, 2.9, -1.7]], dtype=object)
</code></pre><h3 id="索引对象"><a href="#索引对象" class="headerlink" title="索引对象"></a>索引对象</h3><p>Index是一个可以单独提取出来的对象</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">obj = Series(range(<span class="number">3</span>), index=[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>])</div><div class="line">index = obj.index</div><div class="line">index</div></pre></td></tr></table></figure><pre><code>Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], dtype=&#39;object&#39;)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">index[<span class="number">1</span>:]</div></pre></td></tr></table></figure><pre><code>Index([&#39;b&#39;, &#39;c&#39;], dtype=&#39;object&#39;)
</code></pre><p>不可修改~！</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">index[<span class="number">1</span>] = <span class="string">'d'</span></div></pre></td></tr></table></figure><pre><code>---------------------------------------------------------------------------

TypeError                                 Traceback (most recent call last)

&lt;ipython-input-52-676fdeb26a68&gt; in &lt;module&gt;()
----&gt; 1 index[1] = &#39;d&#39;


C:\Users\Ewan\Anaconda3\lib\site-packages\pandas\indexes\base.py in __setitem__(self, key, value)
   1243 
   1244     def __setitem__(self, key, value):
-&gt; 1245         raise TypeError(&quot;Index does not support mutable operations&quot;)
   1246 
   1247     def __getitem__(self, key):


TypeError: Index does not support mutable operations
</code></pre><p>直接创建Index对象</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">index = pd.Index(np.arange(<span class="number">3</span>))</div><div class="line">obj2 = Series([<span class="number">1.5</span>, <span class="number">-2.5</span>, <span class="number">0</span>], index=index)</div><div class="line">obj2.index <span class="keyword">is</span> index</div></pre></td></tr></table></figure><pre><code>True
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame3</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th>state</th><th>Nevada</th><th>Ohio</th></tr><tr><th>year</th><th></th><th></th></tr></thead><tbody><tr><th>2000</th><td>NaN</td><td>1.5</td></tr><tr><th>2001</th><td>2.4</td><td>1.7</td></tr><tr><th>2002</th><td>2.9</td><td>3.6</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">'Ohio'</span> <span class="keyword">in</span> frame3.columns</div></pre></td></tr></table></figure><pre><code>True
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="number">2003</span> <span class="keyword">in</span> frame3.index</div></pre></td></tr></table></figure><pre><code>False
</code></pre><h2 id="基本功能"><a href="#基本功能" class="headerlink" title="基本功能"></a>基本功能</h2><h3 id="重新索引"><a href="#重新索引" class="headerlink" title="重新索引"></a>重新索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">obj = Series([<span class="number">4.5</span>, <span class="number">7.2</span>, <span class="number">-5.3</span>, <span class="number">3.6</span>], index=[<span class="string">'d'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'c'</span>])</div><div class="line">obj</div></pre></td></tr></table></figure><pre><code>d    4.5
b    7.2
a   -5.3
c    3.6
dtype: float64
</code></pre><p>重排索引形成新对象</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">obj2 = obj.reindex([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>])</div><div class="line">obj2</div></pre></td></tr></table></figure><pre><code>a   -5.3
b    7.2
c    3.6
d    4.5
e    NaN
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj.reindex([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>], fill_value=<span class="number">0</span>)</div></pre></td></tr></table></figure><pre><code>a   -5.3
b    7.2
c    3.6
d    4.5
e    0.0
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">obj3 = Series([<span class="string">'blue'</span>, <span class="string">'purple'</span>, <span class="string">'yellow'</span>], index=[<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>])</div><div class="line">obj3.reindex(range(<span class="number">6</span>), method=<span class="string">'ffill'</span>) <span class="comment"># 前向填充</span></div></pre></td></tr></table></figure><pre><code>0      blue
1      blue
2    purple
3    purple
4    yellow
5    yellow
dtype: object
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">frame = DataFrame(np.arange(<span class="number">9</span>).reshape((<span class="number">3</span>, <span class="number">3</span>)), index=[<span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>],</div><div class="line">                  columns=[<span class="string">'Ohio'</span>, <span class="string">'Texas'</span>, <span class="string">'California'</span>])</div><div class="line">frame</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Ohio</th><th>Texas</th><th>California</th></tr></thead><tbody><tr><th>a</th><td>0</td><td>1</td><td>2</td></tr><tr><th>c</th><td>3</td><td>4</td><td>5</td></tr><tr><th>d</th><td>6</td><td>7</td><td>8</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">frame2 = frame.reindex([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>])</div><div class="line">frame2</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Ohio</th><th>Texas</th><th>California</th></tr></thead><tbody><tr><th>a</th><td>0.0</td><td>1.0</td><td>2.0</td></tr><tr><th>b</th><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>c</th><td>3.0</td><td>4.0</td><td>5.0</td></tr><tr><th>d</th><td>6.0</td><td>7.0</td><td>8.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">states = [<span class="string">'Texas'</span>, <span class="string">'Utah'</span>, <span class="string">'California'</span>]</div><div class="line">frame.reindex(columns=states)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Texas</th><th>Utah</th><th>California</th></tr></thead><tbody><tr><th>a</th><td>1</td><td>NaN</td><td>2</td></tr><tr><th>c</th><td>4</td><td>NaN</td><td>5</td></tr><tr><th>d</th><td>7</td><td>NaN</td><td>8</td></tr></tbody></table></div><p>插值只能按行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">frame.reindex(index=[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>], method=<span class="string">'ffill'</span>,</div><div class="line">              columns=states)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Texas</th><th>Utah</th><th>California</th></tr></thead><tbody><tr><th>a</th><td>1</td><td>NaN</td><td>2</td></tr><tr><th>b</th><td>1</td><td>NaN</td><td>2</td></tr><tr><th>c</th><td>4</td><td>NaN</td><td>5</td></tr><tr><th>d</th><td>7</td><td>NaN</td><td>8</td></tr></tbody></table></div><p>用ix方法进行重新索引操作会使得代码很简洁</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame.ix[[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>], states]</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Texas</th><th>Utah</th><th>California</th></tr></thead><tbody><tr><th>a</th><td>1.0</td><td>NaN</td><td>2.0</td></tr><tr><th>b</th><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>c</th><td>4.0</td><td>NaN</td><td>5.0</td></tr><tr><th>d</th><td>7.0</td><td>NaN</td><td>8.0</td></tr></tbody></table></div><h3 id="丢弃指定轴上的项"><a href="#丢弃指定轴上的项" class="headerlink" title="丢弃指定轴上的项"></a>丢弃指定轴上的项</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame.ix[[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>], states]</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Texas</th><th>Utah</th><th>California</th></tr></thead><tbody><tr><th>a</th><td>1.0</td><td>NaN</td><td>2.0</td></tr><tr><th>b</th><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>c</th><td>4.0</td><td>NaN</td><td>5.0</td></tr><tr><th>d</th><td>7.0</td><td>NaN</td><td>8.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">obj = Series(np.arange(<span class="number">5.</span>), index=[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>])</div><div class="line">new_obj = obj.drop(<span class="string">'c'</span>)</div><div class="line">new_obj</div></pre></td></tr></table></figure><pre><code>a    0.0
b    1.0
d    3.0
e    4.0
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj.drop([<span class="string">'d'</span>, <span class="string">'c'</span>])</div></pre></td></tr></table></figure><pre><code>a    0.0
b    1.0
e    4.0
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">data = DataFrame(np.arange(<span class="number">16</span>).reshape((<span class="number">4</span>, <span class="number">4</span>)),</div><div class="line">                 index=[<span class="string">'Ohio'</span>, <span class="string">'Colorado'</span>, <span class="string">'Utah'</span>, <span class="string">'New York'</span>],</div><div class="line">                 columns=[<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>, <span class="string">'four'</span>])</div><div class="line">data</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th><th>three</th><th>four</th></tr></thead><tbody><tr><th>Ohio</th><td>0</td><td>1</td><td>2</td><td>3</td></tr><tr><th>Colorado</th><td>4</td><td>5</td><td>6</td><td>7</td></tr><tr><th>Utah</th><td>8</td><td>9</td><td>10</td><td>11</td></tr><tr><th>New York</th><td>12</td><td>13</td><td>14</td><td>15</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data.drop([<span class="string">'Colorado'</span>, <span class="string">'Ohio'</span>])</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th><th>three</th><th>four</th></tr></thead><tbody><tr><th>Utah</th><td>8</td><td>9</td><td>10</td><td>11</td></tr><tr><th>New York</th><td>12</td><td>13</td><td>14</td><td>15</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data.drop(<span class="string">'two'</span>, axis=<span class="number">1</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>three</th><th>four</th></tr></thead><tbody><tr><th>Ohio</th><td>0</td><td>2</td><td>3</td></tr><tr><th>Colorado</th><td>4</td><td>6</td><td>7</td></tr><tr><th>Utah</th><td>8</td><td>10</td><td>11</td></tr><tr><th>New York</th><td>12</td><td>14</td><td>15</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data.drop([<span class="string">'two'</span>, <span class="string">'four'</span>], axis=<span class="number">1</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>three</th></tr></thead><tbody><tr><th>Ohio</th><td>0</td><td>2</td></tr><tr><th>Colorado</th><td>4</td><td>6</td></tr><tr><th>Utah</th><td>8</td><td>10</td></tr><tr><th>New York</th><td>12</td><td>14</td></tr></tbody></table></div><h3 id="索引，选取和过滤"><a href="#索引，选取和过滤" class="headerlink" title="索引，选取和过滤"></a>索引，选取和过滤</h3><p>多种索引方式</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">obj = Series(np.arange(<span class="number">4.</span>), index=[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>])</div><div class="line">obj</div><div class="line">obj[<span class="string">'b'</span>]</div></pre></td></tr></table></figure><pre><code>a    0.0
b    1.0
c    2.0
d    3.0
dtype: float64






1.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj[<span class="number">1</span>]</div></pre></td></tr></table></figure><pre><code>1.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj[<span class="number">2</span>:<span class="number">4</span>]</div></pre></td></tr></table></figure><pre><code>c    2.0
d    3.0
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj[[<span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'d'</span>]]</div></pre></td></tr></table></figure><pre><code>b    1.0
a    0.0
d    3.0
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj[[<span class="number">1</span>, <span class="number">3</span>]]</div></pre></td></tr></table></figure><pre><code>b    1.0
d    3.0
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj[obj &lt; <span class="number">2</span>] <span class="comment"># 直接对data进行操作</span></div></pre></td></tr></table></figure><pre><code>a    0.0
b    1.0
dtype: float64
</code></pre><p>这种切片方式…<br>末端包含</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj[<span class="string">'b'</span>:<span class="string">'c'</span>]</div></pre></td></tr></table></figure><pre><code>b    1.0
c    2.0
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">obj[<span class="string">'b'</span>:<span class="string">'c'</span>] = <span class="number">5</span></div><div class="line">obj</div></pre></td></tr></table></figure><pre><code>a    0.0
b    5.0
c    5.0
d    3.0
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">data = DataFrame(np.arange(<span class="number">16</span>).reshape((<span class="number">4</span>, <span class="number">4</span>)),</div><div class="line">                 index=[<span class="string">'Ohio'</span>, <span class="string">'Colorado'</span>, <span class="string">'Utah'</span>, <span class="string">'New York'</span>],</div><div class="line">                 columns=[<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>, <span class="string">'four'</span>])</div><div class="line">data</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th><th>three</th><th>four</th></tr></thead><tbody><tr><th>Ohio</th><td>0</td><td>1</td><td>2</td><td>3</td></tr><tr><th>Colorado</th><td>4</td><td>5</td><td>6</td><td>7</td></tr><tr><th>Utah</th><td>8</td><td>9</td><td>10</td><td>11</td></tr><tr><th>New York</th><td>12</td><td>13</td><td>14</td><td>15</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data[<span class="string">'two'</span>]</div></pre></td></tr></table></figure><pre><code>Ohio         1
Colorado     5
Utah         9
New York    13
Name: two, dtype: int32
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data[[<span class="string">'three'</span>, <span class="string">'one'</span>]]</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>three</th><th>one</th></tr></thead><tbody><tr><th>Ohio</th><td>2</td><td>0</td></tr><tr><th>Colorado</th><td>6</td><td>4</td></tr><tr><th>Utah</th><td>10</td><td>8</td></tr><tr><th>New York</th><td>14</td><td>12</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data[:<span class="number">2</span>] <span class="comment"># axis=0</span></div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th><th>three</th><th>four</th></tr></thead><tbody><tr><th>Ohio</th><td>0</td><td>1</td><td>2</td><td>3</td></tr><tr><th>Colorado</th><td>4</td><td>5</td><td>6</td><td>7</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data[data[<span class="string">'three'</span>] &gt; <span class="number">5</span>]</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th><th>three</th><th>four</th></tr></thead><tbody><tr><th>Colorado</th><td>4</td><td>5</td><td>6</td><td>7</td></tr><tr><th>Utah</th><td>8</td><td>9</td><td>10</td><td>11</td></tr><tr><th>New York</th><td>12</td><td>13</td><td>14</td><td>15</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data &lt; <span class="number">5</span></div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th><th>three</th><th>four</th></tr></thead><tbody><tr><th>Ohio</th><td>True</td><td>True</td><td>True</td><td>True</td></tr><tr><th>Colorado</th><td>True</td><td>False</td><td>False</td><td>False</td></tr><tr><th>Utah</th><td>False</td><td>False</td><td>False</td><td>False</td></tr><tr><th>New York</th><td>False</td><td>False</td><td>False</td><td>False</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data[data &lt; <span class="number">5</span>] = <span class="number">0</span></div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th><th>three</th><th>four</th></tr></thead><tbody><tr><th>Ohio</th><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><th>Colorado</th><td>0</td><td>5</td><td>6</td><td>7</td></tr><tr><th>Utah</th><td>8</td><td>9</td><td>10</td><td>11</td></tr><tr><th>New York</th><td>12</td><td>13</td><td>14</td><td>15</td></tr></tbody></table></div><p>索引的另外一种选择</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data.ix[<span class="string">'Colorado'</span>, [<span class="string">'two'</span>, <span class="string">'three'</span>]]</div></pre></td></tr></table></figure><pre><code>two      5
three    6
Name: Colorado, dtype: int32
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data.ix[[<span class="string">'Colorado'</span>, <span class="string">'Utah'</span>], [<span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>]]</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>four</th><th>one</th><th>two</th></tr></thead><tbody><tr><th>Colorado</th><td>7</td><td>0</td><td>5</td></tr><tr><th>Utah</th><td>11</td><td>8</td><td>9</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data.ix[<span class="number">2</span>]</div></pre></td></tr></table></figure><pre><code>one       8
two       9
three    10
four     11
Name: Utah, dtype: int32
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data.ix[:<span class="string">'Utah'</span>, <span class="string">'two'</span>]</div></pre></td></tr></table></figure><pre><code>Ohio        0
Colorado    5
Utah        9
Name: two, dtype: int32
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data.ix[data.three &gt; <span class="number">5</span>, :<span class="number">3</span>]</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th><th>three</th></tr></thead><tbody><tr><th>Colorado</th><td>0</td><td>5</td><td>6</td></tr><tr><th>Utah</th><td>8</td><td>9</td><td>10</td></tr><tr><th>New York</th><td>12</td><td>13</td><td>14</td></tr></tbody></table></div><p>总结一下就是说，DataFrame是一个二维的数组，只不过每一维的索引方式除了序号之外，还可以用name属性来进行索引，且一切行为与序号无异</p><h3 id="算术运算和数据对齐"><a href="#算术运算和数据对齐" class="headerlink" title="算术运算和数据对齐"></a>算术运算和数据对齐</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">s1 = Series([<span class="number">7.3</span>, <span class="number">-2.5</span>, <span class="number">3.4</span>, <span class="number">1.5</span>], index=[<span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>])</div><div class="line">s2 = Series([<span class="number">-2.1</span>, <span class="number">3.6</span>, <span class="number">-1.5</span>, <span class="number">4</span>, <span class="number">3.1</span>], index=[<span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'g'</span>])</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">s1</div></pre></td></tr></table></figure><pre><code>a    7.3
c   -2.5
d    3.4
e    1.5
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">s2</div></pre></td></tr></table></figure><pre><code>a   -2.1
c    3.6
e   -1.5
f    4.0
g    3.1
dtype: float64
</code></pre><p>数据对齐操作就是一种特殊的并集操作</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">s1 + s2</div></pre></td></tr></table></figure><pre><code>a    5.2
c    1.1
d    NaN
e    0.0
f    NaN
g    NaN
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">df1 = DataFrame(np.arange(<span class="number">9.</span>).reshape((<span class="number">3</span>, <span class="number">3</span>)), columns=list(<span class="string">'bcd'</span>),</div><div class="line">                index=[<span class="string">'Ohio'</span>, <span class="string">'Texas'</span>, <span class="string">'Colorado'</span>])</div><div class="line">df2 = DataFrame(np.arange(<span class="number">12.</span>).reshape((<span class="number">4</span>, <span class="number">3</span>)), columns=list(<span class="string">'bde'</span>),</div><div class="line">                index=[<span class="string">'Utah'</span>, <span class="string">'Ohio'</span>, <span class="string">'Texas'</span>, <span class="string">'Oregon'</span>])</div><div class="line">df1</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>c</th><th>d</th></tr></thead><tbody><tr><th>Ohio</th><td>0.0</td><td>1.0</td><td>2.0</td></tr><tr><th>Texas</th><td>3.0</td><td>4.0</td><td>5.0</td></tr><tr><th>Colorado</th><td>6.0</td><td>7.0</td><td>8.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df2</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Utah</th><td>0.0</td><td>1.0</td><td>2.0</td></tr><tr><th>Ohio</th><td>3.0</td><td>4.0</td><td>5.0</td></tr><tr><th>Texas</th><td>6.0</td><td>7.0</td><td>8.0</td></tr><tr><th>Oregon</th><td>9.0</td><td>10.0</td><td>11.0</td></tr></tbody></table></div><p>并且数据对齐操作是在所有维度上同时进行的</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df1 + df2</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>c</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Colorado</th><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>Ohio</th><td>3.0</td><td>NaN</td><td>6.0</td><td>NaN</td></tr><tr><th>Oregon</th><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>Texas</th><td>9.0</td><td>NaN</td><td>12.0</td><td>NaN</td></tr><tr><th>Utah</th><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr></tbody></table></div><h4 id="在算术方法中填充词"><a href="#在算术方法中填充词" class="headerlink" title="在算术方法中填充词"></a>在算术方法中填充词</h4><p>下面这种定义column的方式值得注意</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">df1 = DataFrame(np.arange(<span class="number">12.</span>).reshape((<span class="number">3</span>, <span class="number">4</span>)), columns=list(<span class="string">'abcd'</span>))</div><div class="line">df2 = DataFrame(np.arange(<span class="number">20.</span>).reshape((<span class="number">4</span>, <span class="number">5</span>)), columns=list(<span class="string">'abcde'</span>))</div><div class="line">df1</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th><th>c</th><th>d</th></tr></thead><tbody><tr><th>0</th><td>0.0</td><td>1.0</td><td>2.0</td><td>3.0</td></tr><tr><th>1</th><td>4.0</td><td>5.0</td><td>6.0</td><td>7.0</td></tr><tr><th>2</th><td>8.0</td><td>9.0</td><td>10.0</td><td>11.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df2</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th><th>c</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>0</th><td>0.0</td><td>1.0</td><td>2.0</td><td>3.0</td><td>4.0</td></tr><tr><th>1</th><td>5.0</td><td>6.0</td><td>7.0</td><td>8.0</td><td>9.0</td></tr><tr><th>2</th><td>10.0</td><td>11.0</td><td>12.0</td><td>13.0</td><td>14.0</td></tr><tr><th>3</th><td>15.0</td><td>16.0</td><td>17.0</td><td>18.0</td><td>19.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df1 + df2</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th><th>c</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>0</th><td>0.0</td><td>2.0</td><td>4.0</td><td>6.0</td><td>NaN</td></tr><tr><th>1</th><td>9.0</td><td>11.0</td><td>13.0</td><td>15.0</td><td>NaN</td></tr><tr><th>2</th><td>18.0</td><td>20.0</td><td>22.0</td><td>24.0</td><td>NaN</td></tr><tr><th>3</th><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr></tbody></table></div><p>要想填充值必须使用add方法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df1.add(df2, fill_value=<span class="number">0</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th><th>c</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>0</th><td>0.0</td><td>2.0</td><td>4.0</td><td>6.0</td><td>4.0</td></tr><tr><th>1</th><td>9.0</td><td>11.0</td><td>13.0</td><td>15.0</td><td>9.0</td></tr><tr><th>2</th><td>18.0</td><td>20.0</td><td>22.0</td><td>24.0</td><td>14.0</td></tr><tr><th>3</th><td>15.0</td><td>16.0</td><td>17.0</td><td>18.0</td><td>19.0</td></tr></tbody></table></div><p>reindex方法与add方法还是存在差异的</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df1.reindex(columns=df2.columns, fill_value=<span class="number">0</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th><th>c</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>0</th><td>0.0</td><td>1.0</td><td>2.0</td><td>3.0</td><td>0</td></tr><tr><th>1</th><td>4.0</td><td>5.0</td><td>6.0</td><td>7.0</td><td>0</td></tr><tr><th>2</th><td>8.0</td><td>9.0</td><td>10.0</td><td>11.0</td><td>0</td></tr></tbody></table></div><h4 id="DataFrame和Series之间的运算"><a href="#DataFrame和Series之间的运算" class="headerlink" title="DataFrame和Series之间的运算"></a>DataFrame和Series之间的运算</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">arr = np.arange(<span class="number">12.</span>).reshape((<span class="number">3</span>, <span class="number">4</span>))</div><div class="line">arr</div></pre></td></tr></table></figure><pre><code>array([[  0.,   1.,   2.,   3.],
       [  4.,   5.,   6.,   7.],
       [  8.,   9.,  10.,  11.]])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">arr[<span class="number">0</span>]</div></pre></td></tr></table></figure><pre><code>array([ 0.,  1.,  2.,  3.])
</code></pre><p>广播操作</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">arr - arr[<span class="number">0</span>]</div></pre></td></tr></table></figure><pre><code>array([[ 0.,  0.,  0.,  0.],
       [ 4.,  4.,  4.,  4.],
       [ 8.,  8.,  8.,  8.]])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">frame = DataFrame(np.arange(<span class="number">12.</span>).reshape((<span class="number">4</span>, <span class="number">3</span>)), columns=list(<span class="string">'bde'</span>),</div><div class="line">                  index=[<span class="string">'Utah'</span>, <span class="string">'Ohio'</span>, <span class="string">'Texas'</span>, <span class="string">'Oregon'</span>])</div><div class="line">series = frame.ix[<span class="number">0</span>]</div><div class="line">frame</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Utah</th><td>0.0</td><td>1.0</td><td>2.0</td></tr><tr><th>Ohio</th><td>3.0</td><td>4.0</td><td>5.0</td></tr><tr><th>Texas</th><td>6.0</td><td>7.0</td><td>8.0</td></tr><tr><th>Oregon</th><td>9.0</td><td>10.0</td><td>11.0</td></tr></tbody></table></div><p>Series的name等于DataFrame的切片属性</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">series</div></pre></td></tr></table></figure><pre><code>b    0.0
d    1.0
e    2.0
Name: Utah, dtype: float64
</code></pre><p>默认情况下，DataFrame和Series之间的算术运算会将Series的index匹配到DataFrame的column, 然后沿着行向下广播</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame - series</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Utah</th><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><th>Ohio</th><td>3.0</td><td>3.0</td><td>3.0</td></tr><tr><th>Texas</th><td>6.0</td><td>6.0</td><td>6.0</td></tr><tr><th>Oregon</th><td>9.0</td><td>9.0</td><td>9.0</td></tr></tbody></table></div><p>如果Series的index与DataFrame的column不匹配，则进行数据对齐</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">series2 = Series(range(<span class="number">3</span>), index=[<span class="string">'b'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>])</div><div class="line">frame + series2</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th><th>f</th></tr></thead><tbody><tr><th>Utah</th><td>0.0</td><td>NaN</td><td>3.0</td><td>NaN</td></tr><tr><th>Ohio</th><td>3.0</td><td>NaN</td><td>6.0</td><td>NaN</td></tr><tr><th>Texas</th><td>6.0</td><td>NaN</td><td>9.0</td><td>NaN</td></tr><tr><th>Oregon</th><td>9.0</td><td>NaN</td><td>12.0</td><td>NaN</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">series3 = frame[<span class="string">'d'</span>]</div><div class="line">frame</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Utah</th><td>0.0</td><td>1.0</td><td>2.0</td></tr><tr><th>Ohio</th><td>3.0</td><td>4.0</td><td>5.0</td></tr><tr><th>Texas</th><td>6.0</td><td>7.0</td><td>8.0</td></tr><tr><th>Oregon</th><td>9.0</td><td>10.0</td><td>11.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">series3</div></pre></td></tr></table></figure><pre><code>Utah       1.0
Ohio       4.0
Texas      7.0
Oregon    10.0
Name: d, dtype: float64
</code></pre><p>匹配行并且在列上进行广播， 就必须要指定axis</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">frame.sub(series3, axis=<span class="number">0</span>)</div><div class="line">frame.sub(series3, axis=<span class="number">1</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Utah</th><td>-1.0</td><td>0.0</td><td>1.0</td></tr><tr><th>Ohio</th><td>-1.0</td><td>0.0</td><td>1.0</td></tr><tr><th>Texas</th><td>-1.0</td><td>0.0</td><td>1.0</td></tr><tr><th>Oregon</th><td>-1.0</td><td>0.0</td><td>1.0</td></tr></tbody></table></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Ohio</th><th>Oregon</th><th>Texas</th><th>Utah</th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Utah</th><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>Ohio</th><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>Texas</th><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>Oregon</th><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr></tbody></table></div><h3 id="函数应用和映射"><a href="#函数应用和映射" class="headerlink" title="函数应用和映射"></a>函数应用和映射</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">frame = DataFrame(np.random.randn(<span class="number">4</span>, <span class="number">3</span>), columns=list(<span class="string">'bde'</span>),</div><div class="line">                  index=[<span class="string">'Utah'</span>, <span class="string">'Ohio'</span>, <span class="string">'Texas'</span>, <span class="string">'Oregon'</span>])</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Utah</th><td>-0.204708</td><td>0.478943</td><td>-0.519439</td></tr><tr><th>Ohio</th><td>-0.555730</td><td>1.965781</td><td>1.393406</td></tr><tr><th>Texas</th><td>0.092908</td><td>0.281746</td><td>0.769023</td></tr><tr><th>Oregon</th><td>1.246435</td><td>1.007189</td><td>-1.296221</td></tr></tbody></table></div><p>Numpy的元素级方法也可以应用到DataFrame上，直接把DataFrame当作二维的Numpy.array即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">np.abs(frame)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Utah</th><td>0.204708</td><td>0.478943</td><td>0.519439</td></tr><tr><th>Ohio</th><td>0.555730</td><td>1.965781</td><td>1.393406</td></tr><tr><th>Texas</th><td>0.092908</td><td>0.281746</td><td>0.769023</td></tr><tr><th>Oregon</th><td>1.246435</td><td>1.007189</td><td>1.296221</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">f = <span class="keyword">lambda</span> x: x.max() - x.min()</div></pre></td></tr></table></figure><p>apply方法将函数映射到由各行或者各列形成的一维数组上</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame.apply(f) <span class="comment"># axis=0</span></div></pre></td></tr></table></figure><pre><code>b    1.802165
d    1.684034
e    2.689627
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame.apply(f, axis=<span class="number">1</span>)</div></pre></td></tr></table></figure><pre><code>Utah      0.998382
Ohio      2.521511
Texas     0.676115
Oregon    2.542656
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="keyword">return</span> Series([x.min(), x.max()], index=[<span class="string">'min'</span>, <span class="string">'max'</span>])</div><div class="line">frame.apply(f)</div><div class="line">frame.apply(f, axis=<span class="number">1</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>min</th><td>-0.555730</td><td>0.281746</td><td>-1.296221</td></tr><tr><th>max</th><td>1.246435</td><td>1.965781</td><td>1.393406</td></tr></tbody></table></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>min</th><th>max</th></tr></thead><tbody><tr><th>Utah</th><td>-0.519439</td><td>0.478943</td></tr><tr><th>Ohio</th><td>-0.555730</td><td>1.965781</td></tr><tr><th>Texas</th><td>0.092908</td><td>0.769023</td></tr><tr><th>Oregon</th><td>-1.296221</td><td>1.246435</td></tr></tbody></table></div><p>元素级的函数映射applymap， 之所以叫这个名字是因为Series有一个元素级的映射函数map</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">format = <span class="keyword">lambda</span> x: <span class="string">'%.2f'</span> % x</div><div class="line">frame.applymap(format)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Utah</th><td>-0.20</td><td>0.48</td><td>-0.52</td></tr><tr><th>Ohio</th><td>-0.56</td><td>1.97</td><td>1.39</td></tr><tr><th>Texas</th><td>0.09</td><td>0.28</td><td>0.77</td></tr><tr><th>Oregon</th><td>1.25</td><td>1.01</td><td>-1.30</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame[<span class="string">'e'</span>].map(format)</div></pre></td></tr></table></figure><pre><code>Utah      -0.52
Ohio       1.39
Texas      0.77
Oregon    -1.30
Name: e, dtype: object
</code></pre><h3 id="排序和排名"><a href="#排序和排名" class="headerlink" title="排序和排名"></a>排序和排名</h3><p>对索引或者column进行（字典）排序</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">obj = Series(range(<span class="number">4</span>), index=[<span class="string">'d'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>])</div><div class="line">obj.sort_index()</div></pre></td></tr></table></figure><pre><code>a    1
b    2
c    3
d    0
dtype: int32
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">frame = DataFrame(np.arange(<span class="number">8</span>).reshape((<span class="number">2</span>, <span class="number">4</span>)), index=[<span class="string">'three'</span>, <span class="string">'one'</span>],</div><div class="line">                  columns=[<span class="string">'d'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>])</div><div class="line">frame.sort_index()</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>d</th><th>a</th><th>b</th><th>c</th></tr></thead><tbody><tr><th>one</th><td>4</td><td>5</td><td>6</td><td>7</td></tr><tr><th>three</th><td>0</td><td>1</td><td>2</td><td>3</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame.sort_index(axis=<span class="number">1</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th><th>c</th><th>d</th></tr></thead><tbody><tr><th>three</th><td>1</td><td>2</td><td>3</td><td>0</td></tr><tr><th>one</th><td>5</td><td>6</td><td>7</td><td>4</td></tr></tbody></table></div><p>降序</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame.sort_index(axis=<span class="number">1</span>, ascending=<span class="keyword">False</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>d</th><th>c</th><th>b</th><th>a</th></tr></thead><tbody><tr><th>three</th><td>0</td><td>3</td><td>2</td><td>1</td></tr><tr><th>one</th><td>4</td><td>7</td><td>6</td><td>5</td></tr></tbody></table></div><p>按照data进行排序</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">obj = Series([<span class="number">4</span>, <span class="number">7</span>, <span class="number">-3</span>, <span class="number">2</span>])</div><div class="line">obj.sort_values()</div></pre></td></tr></table></figure><pre><code>2   -3
3    2
0    4
1    7
dtype: int64
</code></pre><p>在排序时，任何缺失值默认都会被放到Series的末尾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">obj = Series([<span class="number">4</span>, np.nan, <span class="number">7</span>, np.nan, <span class="number">-3</span>, <span class="number">2</span>])</div><div class="line">obj.sort_values()</div></pre></td></tr></table></figure><pre><code>4   -3.0
5    2.0
0    4.0
2    7.0
1    NaN
3    NaN
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">frame = DataFrame(&#123;<span class="string">'b'</span>: [<span class="number">4</span>, <span class="number">7</span>, <span class="number">-3</span>, <span class="number">2</span>], <span class="string">'a'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]&#125;)</div><div class="line">frame</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th></tr></thead><tbody><tr><th>0</th><td>0</td><td>4</td></tr><tr><th>1</th><td>1</td><td>7</td></tr><tr><th>2</th><td>0</td><td>-3</td></tr><tr><th>3</th><td>1</td><td>2</td></tr></tbody></table></div><p>对指定index或者column进行排序</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame.sort_values(by=<span class="string">'b'</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th></tr></thead><tbody><tr><th>2</th><td>0</td><td>-3</td></tr><tr><th>3</th><td>1</td><td>2</td></tr><tr><th>0</th><td>0</td><td>4</td></tr><tr><th>1</th><td>1</td><td>7</td></tr></tbody></table></div><p>或者根据multi-index亦或multi-column进行排序</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame.sort_values(by=[<span class="string">'a'</span>, <span class="string">'b'</span>])</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th></tr></thead><tbody><tr><th>2</th><td>0</td><td>-3</td></tr><tr><th>0</th><td>0</td><td>4</td></tr><tr><th>3</th><td>1</td><td>2</td></tr><tr><th>1</th><td>1</td><td>7</td></tr></tbody></table></div><p>默认情况下，rank方法通过“为各组分配一个平均排名”的方式破坏平级关系。也就是说，如果有多个相同的值，则这些值的rank就是这些相同值rand的算术平均。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">obj = Series([<span class="number">7</span>, <span class="number">-5</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">4</span>])</div><div class="line">obj.rank()</div></pre></td></tr></table></figure><pre><code>0    7.5
1    1.0
2    7.5
3    5.0
4    3.0
5    2.0
6    5.0
7    5.0
dtype: float64
</code></pre><p>如果想按照一般方式排名</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj.rank(method=<span class="string">'first'</span>)</div></pre></td></tr></table></figure><pre><code>0    7.0
1    1.0
2    8.0
3    4.0
4    3.0
5    2.0
6    5.0
7    6.0
dtype: float64
</code></pre><p>使用每个分组的最大排名</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj.rank(ascending=<span class="keyword">False</span>, method=<span class="string">'max'</span>)</div></pre></td></tr></table></figure><pre><code>0    2.0
1    8.0
2    2.0
3    5.0
4    6.0
5    7.0
6    5.0
7    5.0
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">frame = DataFrame(&#123;<span class="string">'b'</span>: [<span class="number">4.3</span>, <span class="number">7</span>, <span class="number">-3</span>, <span class="number">2</span>], <span class="string">'a'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</div><div class="line">                   <span class="string">'c'</span>: [<span class="number">-2</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">-2.5</span>]&#125;)</div><div class="line">frame</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th><th>c</th></tr></thead><tbody><tr><th>0</th><td>0</td><td>4.3</td><td>-2.0</td></tr><tr><th>1</th><td>1</td><td>7.0</td><td>5.0</td></tr><tr><th>2</th><td>0</td><td>-3.0</td><td>8.0</td></tr><tr><th>3</th><td>1</td><td>2.0</td><td>-2.5</td></tr></tbody></table></div><p>指定维度</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame.rank(axis=<span class="number">1</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th><th>c</th></tr></thead><tbody><tr><th>0</th><td>2.0</td><td>3.0</td><td>1.0</td></tr><tr><th>1</th><td>1.0</td><td>3.0</td><td>2.0</td></tr><tr><th>2</th><td>2.0</td><td>1.0</td><td>3.0</td></tr><tr><th>3</th><td>2.0</td><td>3.0</td><td>1.0</td></tr></tbody></table></div><h3 id="带有重复值的轴索引"><a href="#带有重复值的轴索引" class="headerlink" title="带有重复值的轴索引"></a>带有重复值的轴索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">obj = Series(range(<span class="number">5</span>), index=[<span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>])</div><div class="line">obj</div></pre></td></tr></table></figure><pre><code>a    0
a    1
b    2
b    3
c    4
dtype: int32
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj.index.is_unique</div></pre></td></tr></table></figure><pre><code>False
</code></pre><p>返回一个Series</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj[<span class="string">'a'</span>]</div></pre></td></tr></table></figure><pre><code>a    0
a    1
dtype: int32
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj[<span class="string">'c'</span>]</div></pre></td></tr></table></figure><pre><code>4
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">df = DataFrame(np.random.randn(<span class="number">4</span>, <span class="number">3</span>), index=[<span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>])</div><div class="line">df</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><th>a</th><td>0.274992</td><td>0.228913</td><td>1.352917</td></tr><tr><th>a</th><td>0.886429</td><td>-2.001637</td><td>-0.371843</td></tr><tr><th>b</th><td>1.669025</td><td>-0.438570</td><td>-0.539741</td></tr><tr><th>b</th><td>0.476985</td><td>3.248944</td><td>-1.021228</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df.ix[<span class="string">'b'</span>]</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><th>b</th><td>1.669025</td><td>-0.438570</td><td>-0.539741</td></tr><tr><th>b</th><td>0.476985</td><td>3.248944</td><td>-1.021228</td></tr></tbody></table></div><h2 id="汇总和计算描述统计"><a href="#汇总和计算描述统计" class="headerlink" title="汇总和计算描述统计"></a>汇总和计算描述统计</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">df = DataFrame([[<span class="number">1.4</span>, np.nan], [<span class="number">7.1</span>, <span class="number">-4.5</span>],</div><div class="line">                [np.nan, np.nan], [<span class="number">0.75</span>, <span class="number">-1.3</span>]],</div><div class="line">               index=[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>],</div><div class="line">               columns=[<span class="string">'one'</span>, <span class="string">'two'</span>])</div><div class="line">df</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th></tr></thead><tbody><tr><th>a</th><td>1.40</td><td>NaN</td></tr><tr><th>b</th><td>7.10</td><td>-4.5</td></tr><tr><th>c</th><td>NaN</td><td>NaN</td></tr><tr><th>d</th><td>0.75</td><td>-1.3</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df.sum() <span class="comment"># axis=0 skipna=True</span></div></pre></td></tr></table></figure><pre><code>one    9.25
two   -5.80
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df.sum(axis=<span class="number">1</span>) <span class="comment"># skipna=True</span></div></pre></td></tr></table></figure><pre><code>a    1.40
b    2.60
c    0.00
d   -0.55
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df.mean(axis=<span class="number">1</span>, skipna=<span class="keyword">False</span>)</div></pre></td></tr></table></figure><pre><code>a      NaN
b    1.300
c      NaN
d   -0.275
dtype: float64
</code></pre><p>返回的是索引</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df.idxmax()</div></pre></td></tr></table></figure><pre><code>one    b
two    d
dtype: object
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df.cumsum()</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th></tr></thead><tbody><tr><th>a</th><td>1.40</td><td>NaN</td></tr><tr><th>b</th><td>8.50</td><td>-4.5</td></tr><tr><th>c</th><td>NaN</td><td>NaN</td></tr><tr><th>d</th><td>9.25</td><td>-5.8</td></tr></tbody></table></div><p>describe对于数值型和非数值型数据的行为不一样</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df.describe()</div></pre></td></tr></table></figure><pre><code>C:\Users\Ewan\Anaconda3\lib\site-packages\numpy\lib\function_base.py:3834: RuntimeWarning: Invalid value encountered in percentile
  RuntimeWarning)
</code></pre><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th></tr></thead><tbody><tr><th>count</th><td>3.000000</td><td>2.000000</td></tr><tr><th>mean</th><td>3.083333</td><td>-2.900000</td></tr><tr><th>std</th><td>3.493685</td><td>2.262742</td></tr><tr><th>min</th><td>0.750000</td><td>-4.500000</td></tr><tr><th>25%</th><td>NaN</td><td>NaN</td></tr><tr><th>50%</th><td>NaN</td><td>NaN</td></tr><tr><th>75%</th><td>NaN</td><td>NaN</td></tr><tr><th>max</th><td>7.100000</td><td>-1.300000</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">obj = Series([<span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>] * <span class="number">4</span>)</div><div class="line">obj</div><div class="line">obj.describe()</div></pre></td></tr></table></figure><pre><code>0     a
1     a
2     b
3     c
4     a
5     a
6     b
7     c
8     a
9     a
10    b
11    c
12    a
13    a
14    b
15    c
dtype: object






count     16
unique     3
top        a
freq       8
dtype: object
</code></pre><h3 id="相关系数和xi"><a href="#相关系数和xi" class="headerlink" title="相关系数和xi"></a>相关系数和xi</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pandas_datareader.data <span class="keyword">as</span> web</div><div class="line"></div><div class="line">all_data = &#123;&#125;</div><div class="line"><span class="keyword">for</span> ticker <span class="keyword">in</span> [<span class="string">'AAPL'</span>, <span class="string">'IBM'</span>, <span class="string">'MSFT'</span>, <span class="string">'GOOG'</span>]:</div><div class="line">    all_data[ticker] = web.get_data_yahoo(ticker)</div><div class="line"></div><div class="line">price = DataFrame(&#123;tic: data[<span class="string">'Adj Close'</span>]</div><div class="line">                   <span class="keyword">for</span> tic, data <span class="keyword">in</span> all_data.items()&#125;)</div><div class="line">volume = DataFrame(&#123;tic: data[<span class="string">'Volume'</span>]</div><div class="line">                    <span class="keyword">for</span> tic, data <span class="keyword">in</span> all_data.items()&#125;)</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">price[:<span class="number">10</span>]</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>AAPL</th><th>GOOG</th><th>IBM</th><th>MSFT</th></tr><tr><th>Date</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>2010-01-04</th><td>27.727039</td><td>313.062468</td><td>111.405000</td><td>25.555485</td></tr><tr><th>2010-01-05</th><td>27.774976</td><td>311.683844</td><td>110.059232</td><td>25.563741</td></tr><tr><th>2010-01-06</th><td>27.333178</td><td>303.826685</td><td>109.344283</td><td>25.406859</td></tr><tr><th>2010-01-07</th><td>27.282650</td><td>296.753749</td><td>108.965786</td><td>25.142634</td></tr><tr><th>2010-01-08</th><td>27.464034</td><td>300.709808</td><td>110.059232</td><td>25.316031</td></tr><tr><th>2010-01-11</th><td>27.221758</td><td>300.255255</td><td>108.906903</td><td>24.994007</td></tr><tr><th>2010-01-12</th><td>26.912110</td><td>294.945572</td><td>109.773245</td><td>24.828866</td></tr><tr><th>2010-01-13</th><td>27.291720</td><td>293.252243</td><td>109.537735</td><td>25.060064</td></tr><tr><th>2010-01-14</th><td>27.133657</td><td>294.630868</td><td>111.287245</td><td>25.563741</td></tr><tr><th>2010-01-15</th><td>26.680198</td><td>289.710772</td><td>110.841458</td><td>25.481172</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">volume[:<span class="number">10</span>]</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>AAPL</th><th>GOOG</th><th>IBM</th><th>MSFT</th></tr><tr><th>Date</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>2010-01-04</th><td>123432400</td><td>3927000</td><td>6155300</td><td>38409100</td></tr><tr><th>2010-01-05</th><td>150476200</td><td>6031900</td><td>6841400</td><td>49749600</td></tr><tr><th>2010-01-06</th><td>138040000</td><td>7987100</td><td>5605300</td><td>58182400</td></tr><tr><th>2010-01-07</th><td>119282800</td><td>12876600</td><td>5840600</td><td>50559700</td></tr><tr><th>2010-01-08</th><td>111902700</td><td>9483900</td><td>4197200</td><td>51197400</td></tr><tr><th>2010-01-11</th><td>115557400</td><td>14479800</td><td>5730400</td><td>68754700</td></tr><tr><th>2010-01-12</th><td>148614900</td><td>9742900</td><td>8081500</td><td>65912100</td></tr><tr><th>2010-01-13</th><td>151473000</td><td>13041800</td><td>6455400</td><td>51863500</td></tr><tr><th>2010-01-14</th><td>108223500</td><td>8511900</td><td>7111800</td><td>63228100</td></tr><tr><th>2010-01-15</th><td>148516900</td><td>10909600</td><td>8494400</td><td>79913200</td></tr></tbody></table></div><p><strong>price.pct_change</strong></p><p><strong>Signature</strong>: price.pct_change(periods=1, fill_method=’pad’, limit=None, freq=None, **kwargs)<br><strong>Docstring</strong>:<br>Percent change over given number of periods.</p><p><strong>Parameters</strong></p><p>periods : int, default 1<br>Periods to shift for forming percent change</p><p>fill_method : str, default ‘pad’<br>How to handle NAs before computing percent changes</p><p>limit : int, default None<br>The number of consecutive NAs to fill before stopping</p><p>freq : DateOffset, timedelta, or offset alias string, optional<br>Increment to use from time series API (e.g. ‘M’ or BDay())</p><p><strong>Returns</strong></p><p>chg : NDFrame</p><p><strong>Notes</strong></p><p>By default, the percentage change is calculated along the stat<br>axis: 0, or <code>Index</code>, for <code>DataFrame</code> and 1, or <code>minor</code> for<br><code>Panel</code>. You can change this with the <code>axis</code> keyword argument.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">returns = price.pct_change()</div><div class="line">returns.tail()</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>AAPL</th><th>GOOG</th><th>IBM</th><th>MSFT</th></tr><tr><th>Date</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>2017-02-21</th><td>0.007221</td><td>0.004335</td><td>-0.002269</td><td>-0.002012</td></tr><tr><th>2017-02-22</th><td>0.002999</td><td>-0.001082</td><td>0.004937</td><td>-0.002016</td></tr><tr><th>2017-02-23</th><td>-0.004230</td><td>0.000686</td><td>0.002760</td><td>0.004040</td></tr><tr><th>2017-02-24</th><td>0.000952</td><td>-0.003236</td><td>-0.001651</td><td>0.000000</td></tr><tr><th>2017-02-27</th><td>0.001976</td><td>0.000772</td><td>-0.010753</td><td>-0.006035</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">returns.MSFT.corr(returns.IBM)</div></pre></td></tr></table></figure><pre><code>0.49525655865062668
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">returns.MSFT.cov(returns.IBM)</div></pre></td></tr></table></figure><pre><code>8.5880535146740545e-05
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">returns.corr()</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>AAPL</th><th>GOOG</th><th>IBM</th><th>MSFT</th></tr></thead><tbody><tr><th>AAPL</th><td>1.000000</td><td>0.409523</td><td>0.381374</td><td>0.388875</td></tr><tr><th>GOOG</th><td>0.409523</td><td>1.000000</td><td>0.402781</td><td>0.470781</td></tr><tr><th>IBM</th><td>0.381374</td><td>0.402781</td><td>1.000000</td><td>0.495257</td></tr><tr><th>MSFT</th><td>0.388875</td><td>0.470781</td><td>0.495257</td><td>1.000000</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">returns.cov()</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>AAPL</th><th>GOOG</th><th>IBM</th><th>MSFT</th></tr></thead><tbody><tr><th>AAPL</th><td>0.000269</td><td>0.000105</td><td>0.000075</td><td>0.000092</td></tr><tr><th>GOOG</th><td>0.000105</td><td>0.000244</td><td>0.000075</td><td>0.000106</td></tr><tr><th>IBM</th><td>0.000075</td><td>0.000075</td><td>0.000144</td><td>0.000086</td></tr><tr><th>MSFT</th><td>0.000092</td><td>0.000106</td><td>0.000086</td><td>0.000209</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">returns.corrwith(returns.IBM)</div></pre></td></tr></table></figure><pre><code>AAPL    0.381374
GOOG    0.402781
IBM     1.000000
MSFT    0.495257
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">returns.corrwith(volume)</div></pre></td></tr></table></figure><pre><code>AAPL   -0.074055
GOOG   -0.009543
IBM    -0.194107
MSFT   -0.090724
dtype: float64
</code></pre><h3 id="唯一值，-值计数以及成员资格"><a href="#唯一值，-值计数以及成员资格" class="headerlink" title="唯一值， 值计数以及成员资格"></a>唯一值， 值计数以及成员资格</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj = Series([<span class="string">'c'</span>, <span class="string">'a'</span>, <span class="string">'d'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'c'</span>])</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">uniques = obj.unique()</div><div class="line">uniques</div></pre></td></tr></table></figure><pre><code>array([&#39;c&#39;, &#39;a&#39;, &#39;d&#39;, &#39;b&#39;], dtype=object)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj.value_counts()</div></pre></td></tr></table></figure><pre><code>c    3
a    3
b    2
d    1
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pd.value_counts(obj.values, sort=<span class="keyword">False</span>)</div></pre></td></tr></table></figure><pre><code>a    3
d    1
b    2
c    3
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mask = obj.isin([<span class="string">'b'</span>, <span class="string">'c'</span>])</div><div class="line">mask</div></pre></td></tr></table></figure><pre><code>0     True
1    False
2    False
3    False
4    False
5     True
6     True
7     True
8     True
dtype: bool
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj[mask]</div></pre></td></tr></table></figure><pre><code>0    c
5    b
6    b
7    c
8    c
dtype: object
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">data = DataFrame(&#123;<span class="string">'Qu1'</span>: [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>],</div><div class="line">                  <span class="string">'Qu2'</span>: [<span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</div><div class="line">                  <span class="string">'Qu3'</span>: [<span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>]&#125;)</div><div class="line">data</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Qu1</th><th>Qu2</th><th>Qu3</th></tr></thead><tbody><tr><th>0</th><td>1</td><td>2</td><td>1</td></tr><tr><th>1</th><td>3</td><td>3</td><td>5</td></tr><tr><th>2</th><td>4</td><td>1</td><td>2</td></tr><tr><th>3</th><td>3</td><td>2</td><td>4</td></tr><tr><th>4</th><td>4</td><td>3</td><td>4</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">result = data.apply(pd.value_counts).fillna(<span class="number">0</span>)</div><div class="line">result</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Qu1</th><th>Qu2</th><th>Qu3</th></tr></thead><tbody><tr><th>1</th><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><th>2</th><td>0.0</td><td>2.0</td><td>1.0</td></tr><tr><th>3</th><td>2.0</td><td>2.0</td><td>0.0</td></tr><tr><th>4</th><td>2.0</td><td>0.0</td><td>2.0</td></tr><tr><th>5</th><td>0.0</td><td>0.0</td><td>1.0</td></tr></tbody></table></div><h2 id="处理缺失数据"><a href="#处理缺失数据" class="headerlink" title="处理缺失数据"></a>处理缺失数据</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">string_data = Series([<span class="string">'aardvark'</span>, <span class="string">'artichoke'</span>, np.nan, <span class="string">'avocado'</span>])</div><div class="line">string_data</div></pre></td></tr></table></figure><pre><code>0     aardvark
1    artichoke
2          NaN
3      avocado
dtype: object
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">string_data.isnull()</div></pre></td></tr></table></figure><pre><code>0    False
1    False
2     True
3    False
dtype: bool
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">string_data[<span class="number">0</span>] = <span class="keyword">None</span></div><div class="line">string_data.isnull()</div></pre></td></tr></table></figure><pre><code>0     True
1    False
2     True
3    False
dtype: bool
</code></pre><h3 id="滤除缺失数据"><a href="#滤除缺失数据" class="headerlink" title="滤除缺失数据"></a>滤除缺失数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> nan <span class="keyword">as</span> NA</div><div class="line">data = Series([<span class="number">1</span>, NA, <span class="number">3.5</span>, NA, <span class="number">7</span>])</div><div class="line">data.dropna()</div></pre></td></tr></table></figure><pre><code>0    1.0
2    3.5
4    7.0
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data[data.notnull()]</div></pre></td></tr></table></figure><pre><code>0    1.0
2    3.5
4    7.0
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">data = DataFrame([[<span class="number">1.</span>, <span class="number">6.5</span>, <span class="number">3.</span>], [<span class="number">1.</span>, NA, NA],</div><div class="line">                  [NA, NA, NA], [NA, <span class="number">6.5</span>, <span class="number">3.</span>]])</div><div class="line">cleaned = data.dropna()</div><div class="line">data</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><th>0</th><td>1.0</td><td>6.5</td><td>3.0</td></tr><tr><th>1</th><td>1.0</td><td>NaN</td><td>NaN</td></tr><tr><th>2</th><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>3</th><td>NaN</td><td>6.5</td><td>3.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cleaned</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><th>0</th><td>1.0</td><td>6.5</td><td>3.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data.dropna(how=<span class="string">'all'</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><th>0</th><td>1.0</td><td>6.5</td><td>3.0</td></tr><tr><th>1</th><td>1.0</td><td>NaN</td><td>NaN</td></tr><tr><th>3</th><td>NaN</td><td>6.5</td><td>3.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data[<span class="number">4</span>] = NA</div><div class="line">data</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th><th>4</th></tr></thead><tbody><tr><th>0</th><td>1.0</td><td>6.5</td><td>3.0</td><td>NaN</td></tr><tr><th>1</th><td>1.0</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>2</th><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>3</th><td>NaN</td><td>6.5</td><td>3.0</td><td>NaN</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data.dropna(axis=<span class="number">1</span>, how=<span class="string">'all'</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><th>0</th><td>1.0</td><td>6.5</td><td>3.0</td></tr><tr><th>1</th><td>1.0</td><td>NaN</td><td>NaN</td></tr><tr><th>2</th><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>3</th><td>NaN</td><td>6.5</td><td>3.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">df = DataFrame(np.random.randn(<span class="number">7</span>, <span class="number">3</span>))</div><div class="line">df.ix[:<span class="number">4</span>, <span class="number">1</span>] = NA; df.ix[:<span class="number">2</span>, <span class="number">2</span>] = NA</div><div class="line">df</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><th>0</th><td>-0.204708</td><td>NaN</td><td>NaN</td></tr><tr><th>1</th><td>-0.555730</td><td>NaN</td><td>NaN</td></tr><tr><th>2</th><td>0.092908</td><td>NaN</td><td>NaN</td></tr><tr><th>3</th><td>1.246435</td><td>NaN</td><td>-1.296221</td></tr><tr><th>4</th><td>0.274992</td><td>NaN</td><td>1.352917</td></tr><tr><th>5</th><td>0.886429</td><td>-2.001637</td><td>-0.371843</td></tr><tr><th>6</th><td>1.669025</td><td>-0.438570</td><td>-0.539741</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df.dropna(thresh=<span class="number">2</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><th>3</th><td>1.246435</td><td>NaN</td><td>-1.296221</td></tr><tr><th>4</th><td>0.274992</td><td>NaN</td><td>1.352917</td></tr><tr><th>5</th><td>0.886429</td><td>-2.001637</td><td>-0.371843</td></tr><tr><th>6</th><td>1.669025</td><td>-0.438570</td><td>-0.539741</td></tr></tbody></table></div><h3 id="填充缺失数据"><a href="#填充缺失数据" class="headerlink" title="填充缺失数据"></a>填充缺失数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df.fillna(<span class="number">0</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><th>0</th><td>-0.204708</td><td>0.000000</td><td>0.000000</td></tr><tr><th>1</th><td>-0.555730</td><td>0.000000</td><td>0.000000</td></tr><tr><th>2</th><td>0.092908</td><td>0.000000</td><td>0.000000</td></tr><tr><th>3</th><td>1.246435</td><td>0.000000</td><td>-1.296221</td></tr><tr><th>4</th><td>0.274992</td><td>0.000000</td><td>1.352917</td></tr><tr><th>5</th><td>0.886429</td><td>-2.001637</td><td>-0.371843</td></tr><tr><th>6</th><td>1.669025</td><td>-0.438570</td><td>-0.539741</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df.fillna(&#123;<span class="number">1</span>: <span class="number">0.5</span>, <span class="number">3</span>: <span class="number">-1</span>&#125;)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><th>0</th><td>-0.204708</td><td>0.500000</td><td>NaN</td></tr><tr><th>1</th><td>-0.555730</td><td>0.500000</td><td>NaN</td></tr><tr><th>2</th><td>0.092908</td><td>0.500000</td><td>NaN</td></tr><tr><th>3</th><td>1.246435</td><td>0.500000</td><td>-1.296221</td></tr><tr><th>4</th><td>0.274992</td><td>0.500000</td><td>1.352917</td></tr><tr><th>5</th><td>0.886429</td><td>-2.001637</td><td>-0.371843</td></tr><tr><th>6</th><td>1.669025</td><td>-0.438570</td><td>-0.539741</td></tr></tbody></table></div><p>fillna默认返回新对象，但也可以对现有对象就地修改</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># always returns a reference to the filled object</span></div><div class="line">_ = df.fillna(<span class="number">0</span>, inplace=<span class="keyword">True</span>)</div><div class="line">df</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><th>0</th><td>-0.204708</td><td>0.000000</td><td>0.000000</td></tr><tr><th>1</th><td>-0.555730</td><td>0.000000</td><td>0.000000</td></tr><tr><th>2</th><td>0.092908</td><td>0.000000</td><td>0.000000</td></tr><tr><th>3</th><td>1.246435</td><td>0.000000</td><td>-1.296221</td></tr><tr><th>4</th><td>0.274992</td><td>0.000000</td><td>1.352917</td></tr><tr><th>5</th><td>0.886429</td><td>-2.001637</td><td>-0.371843</td></tr><tr><th>6</th><td>1.669025</td><td>-0.438570</td><td>-0.539741</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">df = DataFrame(np.random.randn(<span class="number">6</span>, <span class="number">3</span>))</div><div class="line">df.ix[<span class="number">2</span>:, <span class="number">1</span>] = NA; df.ix[<span class="number">4</span>:, <span class="number">2</span>] = NA</div><div class="line">df</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><th>0</th><td>0.476985</td><td>3.248944</td><td>-1.021228</td></tr><tr><th>1</th><td>-0.577087</td><td>0.124121</td><td>0.302614</td></tr><tr><th>2</th><td>0.523772</td><td>NaN</td><td>1.343810</td></tr><tr><th>3</th><td>-0.713544</td><td>NaN</td><td>-2.370232</td></tr><tr><th>4</th><td>-1.860761</td><td>NaN</td><td>NaN</td></tr><tr><th>5</th><td>-1.265934</td><td>NaN</td><td>NaN</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df.fillna(method=<span class="string">'ffill'</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><th>0</th><td>0.476985</td><td>3.248944</td><td>-1.021228</td></tr><tr><th>1</th><td>-0.577087</td><td>0.124121</td><td>0.302614</td></tr><tr><th>2</th><td>0.523772</td><td>0.124121</td><td>1.343810</td></tr><tr><th>3</th><td>-0.713544</td><td>0.124121</td><td>-2.370232</td></tr><tr><th>4</th><td>-1.860761</td><td>0.124121</td><td>-2.370232</td></tr><tr><th>5</th><td>-1.265934</td><td>0.124121</td><td>-2.370232</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df.fillna(method=<span class="string">'ffill'</span>, limit=<span class="number">2</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><th>0</th><td>0.476985</td><td>3.248944</td><td>-1.021228</td></tr><tr><th>1</th><td>-0.577087</td><td>0.124121</td><td>0.302614</td></tr><tr><th>2</th><td>0.523772</td><td>0.124121</td><td>1.343810</td></tr><tr><th>3</th><td>-0.713544</td><td>0.124121</td><td>-2.370232</td></tr><tr><th>4</th><td>-1.860761</td><td>NaN</td><td>-2.370232</td></tr><tr><th>5</th><td>-1.265934</td><td>NaN</td><td>-2.370232</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data = Series([<span class="number">1.</span>, NA, <span class="number">3.5</span>, NA, <span class="number">7</span>])</div><div class="line">data.fillna(data.mean())</div></pre></td></tr></table></figure><pre><code>0    1.000000
1    3.833333
2    3.500000
3    3.833333
4    7.000000
dtype: float64
</code></pre><h2 id="层次索引"><a href="#层次索引" class="headerlink" title="层次索引"></a>层次索引</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">data = Series(np.random.randn(<span class="number">10</span>),</div><div class="line">              index=[[<span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'d'</span>],</div><div class="line">                     [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>]])</div><div class="line">data</div></pre></td></tr></table></figure><pre><code>a  1    0.332883
   2   -2.359419
   3   -0.199543
b  1   -1.541996
   2   -0.970736
   3   -1.307030
c  1    0.286350
   2    0.377984
d  2   -0.753887
   3    0.331286
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data.index</div></pre></td></tr></table></figure><pre><code>MultiIndex(levels=[[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;], [1, 2, 3]],
           labels=[[0, 0, 0, 1, 1, 1, 2, 2, 3, 3], [0, 1, 2, 0, 1, 2, 0, 1, 1, 2]])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data[<span class="string">'b'</span>]</div></pre></td></tr></table></figure><pre><code>1   -1.541996
2   -0.970736
3   -1.307030
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data[<span class="string">'b'</span>:<span class="string">'c'</span>]</div></pre></td></tr></table></figure><pre><code>b  1   -1.541996
   2   -0.970736
   3   -1.307030
c  1    0.286350
   2    0.377984
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data.ix[[<span class="string">'b'</span>, <span class="string">'d'</span>]]</div></pre></td></tr></table></figure><pre><code>b  1   -1.541996
   2   -0.970736
   3   -1.307030
d  2   -0.753887
   3    0.331286
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data[:, <span class="number">2</span>]</div></pre></td></tr></table></figure><pre><code>a   -2.359419
b   -0.970736
c    0.377984
d   -0.753887
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data.unstack()</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>1</th><th>2</th><th>3</th></tr></thead><tbody><tr><th>a</th><td>0.332883</td><td>-2.359419</td><td>-0.199543</td></tr><tr><th>b</th><td>-1.541996</td><td>-0.970736</td><td>-1.307030</td></tr><tr><th>c</th><td>0.286350</td><td>0.377984</td><td>NaN</td></tr><tr><th>d</th><td>NaN</td><td>-0.753887</td><td>0.331286</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data.unstack().stack()</div></pre></td></tr></table></figure><pre><code>a  1    0.332883
   2   -2.359419
   3   -0.199543
b  1   -1.541996
   2   -0.970736
   3   -1.307030
c  1    0.286350
   2    0.377984
d  2   -0.753887
   3    0.331286
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">frame = DataFrame(np.arange(<span class="number">12</span>).reshape((<span class="number">4</span>, <span class="number">3</span>)),</div><div class="line">                  index=[[<span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>]],</div><div class="line">                  columns=[[<span class="string">'Ohio'</span>, <span class="string">'Ohio'</span>, <span class="string">'Colorado'</span>],</div><div class="line">                           [<span class="string">'Green'</span>, <span class="string">'Red'</span>, <span class="string">'Green'</span>]])</div><div class="line">frame</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr><th></th><th></th><th colspan="2" halign="left">Ohio</th><th>Colorado</th></tr><tr><th></th><th></th><th>Green</th><th>Red</th><th>Green</th></tr></thead><tbody><tr><th rowspan="2" valign="top">a</th><th>1</th><td>0</td><td>1</td><td>2</td></tr><tr><th>2</th><td>3</td><td>4</td><td>5</td></tr><tr><th rowspan="2" valign="top">b</th><th>1</th><td>6</td><td>7</td><td>8</td></tr><tr><th>2</th><td>9</td><td>10</td><td>11</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">frame.index.names = [<span class="string">'key1'</span>, <span class="string">'key2'</span>]</div><div class="line">frame.columns.names = [<span class="string">'state'</span>, <span class="string">'color'</span>]</div><div class="line">frame</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr><th></th><th>state</th><th colspan="2" halign="left">Ohio</th><th>Colorado</th></tr><tr><th></th><th>color</th><th>Green</th><th>Red</th><th>Green</th></tr><tr><th>key1</th><th>key2</th><th></th><th></th><th></th></tr></thead><tbody><tr><th rowspan="2" valign="top">a</th><th>1</th><td>0</td><td>1</td><td>2</td></tr><tr><th>2</th><td>3</td><td>4</td><td>5</td></tr><tr><th rowspan="2" valign="top">b</th><th>1</th><td>6</td><td>7</td><td>8</td></tr><tr><th>2</th><td>9</td><td>10</td><td>11</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame[<span class="string">'Ohio'</span>]</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>color</th><th>Green</th><th>Red</th></tr><tr><th>key1</th><th>key2</th><th></th><th></th></tr></thead><tbody><tr><th rowspan="2" valign="top">a</th><th>1</th><td>0</td><td>1</td></tr><tr><th>2</th><td>3</td><td>4</td></tr><tr><th rowspan="2" valign="top">b</th><th>1</th><td>6</td><td>7</td></tr><tr><th>2</th><td>9</td><td>10</td></tr></tbody></table></div><p><strong>创建MultiIndex对象复用</strong><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">MultiIndex.from_arrays([[&apos;Ohio&apos;, &apos;Ohio&apos;, &apos;Colorado&apos;], [&apos;Green&apos;, &apos;Red&apos;, &apos;Green&apos;]],</div><div class="line">                       names=[&apos;state&apos;, &apos;color&apos;])</div></pre></td></tr></table></figure><p></p><h3 id="重排分级顺序"><a href="#重排分级顺序" class="headerlink" title="重排分级顺序"></a>重排分级顺序</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame.swaplevel(<span class="string">'key1'</span>, <span class="string">'key2'</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr><th></th><th>state</th><th colspan="2" halign="left">Ohio</th><th>Colorado</th></tr><tr><th></th><th>color</th><th>Green</th><th>Red</th><th>Green</th></tr><tr><th>key2</th><th>key1</th><th></th><th></th><th></th></tr></thead><tbody><tr><th>1</th><th>a</th><td>0</td><td>1</td><td>2</td></tr><tr><th>2</th><th>a</th><td>3</td><td>4</td><td>5</td></tr><tr><th>1</th><th>b</th><td>6</td><td>7</td><td>8</td></tr><tr><th>2</th><th>b</th><td>9</td><td>10</td><td>11</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame.sortlevel(<span class="number">1</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr><th></th><th>state</th><th colspan="2" halign="left">Ohio</th><th>Colorado</th></tr><tr><th></th><th>color</th><th>Green</th><th>Red</th><th>Green</th></tr><tr><th>key1</th><th>key2</th><th></th><th></th><th></th></tr></thead><tbody><tr><th>a</th><th>1</th><td>0</td><td>1</td><td>2</td></tr><tr><th>b</th><th>1</th><td>6</td><td>7</td><td>8</td></tr><tr><th>a</th><th>2</th><td>3</td><td>4</td><td>5</td></tr><tr><th>b</th><th>2</th><td>9</td><td>10</td><td>11</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame.swaplevel(<span class="number">0</span>, <span class="number">1</span>).sortlevel(<span class="number">0</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr><th></th><th>state</th><th colspan="2" halign="left">Ohio</th><th>Colorado</th></tr><tr><th></th><th>color</th><th>Green</th><th>Red</th><th>Green</th></tr><tr><th>key2</th><th>key1</th><th></th><th></th><th></th></tr></thead><tbody><tr><th rowspan="2" valign="top">1</th><th>a</th><td>0</td><td>1</td><td>2</td></tr><tr><th>b</th><td>6</td><td>7</td><td>8</td></tr><tr><th rowspan="2" valign="top">2</th><th>a</th><td>3</td><td>4</td><td>5</td></tr><tr><th>b</th><td>9</td><td>10</td><td>11</td></tr></tbody></table></div><h3 id="根据级别汇总统计"><a href="#根据级别汇总统计" class="headerlink" title="根据级别汇总统计"></a>根据级别汇总统计</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame.sum(level=<span class="string">'key2'</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr><th>state</th><th colspan="2" halign="left">Ohio</th><th>Colorado</th></tr><tr><th>color</th><th>Green</th><th>Red</th><th>Green</th></tr><tr><th>key2</th><th></th><th></th><th></th></tr></thead><tbody><tr><th>1</th><td>6</td><td>8</td><td>10</td></tr><tr><th>2</th><td>12</td><td>14</td><td>16</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame.sum(level=<span class="string">'color'</span>, axis=<span class="number">1</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>color</th><th>Green</th><th>Red</th></tr><tr><th>key1</th><th>key2</th><th></th><th></th></tr></thead><tbody><tr><th rowspan="2" valign="top">a</th><th>1</th><td>2</td><td>1</td></tr><tr><th>2</th><td>8</td><td>4</td></tr><tr><th rowspan="2" valign="top">b</th><th>1</th><td>14</td><td>7</td></tr><tr><th>2</th><td>20</td><td>10</td></tr></tbody></table></div><h3 id="使用DataFrame的列"><a href="#使用DataFrame的列" class="headerlink" title="使用DataFrame的列"></a>使用DataFrame的列</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">frame = DataFrame(&#123;<span class="string">'a'</span>: range(<span class="number">7</span>), <span class="string">'b'</span>: range(<span class="number">7</span>, <span class="number">0</span>, <span class="number">-1</span>),</div><div class="line">                   <span class="string">'c'</span>: [<span class="string">'one'</span>, <span class="string">'one'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'two'</span>, <span class="string">'two'</span>, <span class="string">'two'</span>],</div><div class="line">                   <span class="string">'d'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]&#125;)</div><div class="line">frame</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th><th>c</th><th>d</th></tr></thead><tbody><tr><th>0</th><td>0</td><td>7</td><td>one</td><td>0</td></tr><tr><th>1</th><td>1</td><td>6</td><td>one</td><td>1</td></tr><tr><th>2</th><td>2</td><td>5</td><td>one</td><td>2</td></tr><tr><th>3</th><td>3</td><td>4</td><td>two</td><td>0</td></tr><tr><th>4</th><td>4</td><td>3</td><td>two</td><td>1</td></tr><tr><th>5</th><td>5</td><td>2</td><td>two</td><td>2</td></tr><tr><th>6</th><td>6</td><td>1</td><td>two</td><td>3</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">frame2 = frame.set_index([<span class="string">'c'</span>, <span class="string">'d'</span>])</div><div class="line">frame2</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th></th><th>a</th><th>b</th></tr><tr><th>c</th><th>d</th><th></th><th></th></tr></thead><tbody><tr><th rowspan="3" valign="top">one</th><th>0</th><td>0</td><td>7</td></tr><tr><th>1</th><td>1</td><td>6</td></tr><tr><th>2</th><td>2</td><td>5</td></tr><tr><th rowspan="4" valign="top">two</th><th>0</th><td>3</td><td>4</td></tr><tr><th>1</th><td>4</td><td>3</td></tr><tr><th>2</th><td>5</td><td>2</td></tr><tr><th>3</th><td>6</td><td>1</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame.set_index([<span class="string">'c'</span>, <span class="string">'d'</span>], drop=<span class="keyword">False</span>)</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th></th><th>a</th><th>b</th><th>c</th><th>d</th></tr><tr><th>c</th><th>d</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th rowspan="3" valign="top">one</th><th>0</th><td>0</td><td>7</td><td>one</td><td>0</td></tr><tr><th>1</th><td>1</td><td>6</td><td>one</td><td>1</td></tr><tr><th>2</th><td>2</td><td>5</td><td>one</td><td>2</td></tr><tr><th rowspan="4" valign="top">two</th><th>0</th><td>3</td><td>4</td><td>two</td><td>0</td></tr><tr><th>1</th><td>4</td><td>3</td><td>two</td><td>1</td></tr><tr><th>2</th><td>5</td><td>2</td><td>two</td><td>2</td></tr><tr><th>3</th><td>6</td><td>1</td><td>two</td><td>3</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame2.reset_index()</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>c</th><th>d</th><th>a</th><th>b</th></tr></thead><tbody><tr><th>0</th><td>one</td><td>0</td><td>0</td><td>7</td></tr><tr><th>1</th><td>one</td><td>1</td><td>1</td><td>6</td></tr><tr><th>2</th><td>one</td><td>2</td><td>2</td><td>5</td></tr><tr><th>3</th><td>two</td><td>0</td><td>3</td><td>4</td></tr><tr><th>4</th><td>two</td><td>1</td><td>4</td><td>3</td></tr><tr><th>5</th><td>two</td><td>2</td><td>5</td><td>2</td></tr><tr><th>6</th><td>two</td><td>3</td><td>6</td><td>1</td></tr></tbody></table></div><h2 id="拓展话题"><a href="#拓展话题" class="headerlink" title="拓展话题"></a>拓展话题</h2><h3 id="整数索引"><a href="#整数索引" class="headerlink" title="整数索引"></a>整数索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ser = Series(np.arange(<span class="number">3.</span>))</div><div class="line">ser.iloc[<span class="number">-1</span>]</div></pre></td></tr></table></figure><pre><code>2.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ser</div></pre></td></tr></table></figure><pre><code>0    0.0
1    1.0
2    2.0
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ser2 = Series(np.arange(<span class="number">3.</span>), index=[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>])</div><div class="line">ser2[<span class="number">-1</span>]</div></pre></td></tr></table></figure><pre><code>2.0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ser.ix[:<span class="number">1</span>]</div></pre></td></tr></table></figure><pre><code>0    0.0
1    1.0
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ser3 = Series(range(<span class="number">3</span>), index=[<span class="number">-5</span>, <span class="number">1</span>, <span class="number">3</span>])</div><div class="line">ser3.iloc[<span class="number">2</span>]</div></pre></td></tr></table></figure><pre><code>2
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">frame = DataFrame(np.arange(<span class="number">6</span>).reshape((<span class="number">3</span>, <span class="number">2</span>)), index=[<span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>])</div><div class="line">frame</div><div class="line">frame.iloc[<span class="number">0</span>]</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th></tr></thead><tbody><tr><th>2</th><td>0</td><td>1</td></tr><tr><th>0</th><td>2</td><td>3</td></tr><tr><th>1</th><td>4</td><td>5</td></tr></tbody></table></div><pre><code>0    0
1    1
Name: 2, dtype: int32
</code></pre><h3 id="面板数据"><a href="#面板数据" class="headerlink" title="面板数据"></a>面板数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pandas_datareader.data <span class="keyword">as</span> web</div><div class="line"></div><div class="line">pdata = pd.Panel(dict((stk, web.get_data_yahoo(stk))</div><div class="line">                       <span class="keyword">for</span> stk <span class="keyword">in</span> [<span class="string">'AAPL'</span>, <span class="string">'GOOG'</span>, <span class="string">'MSFT'</span>, <span class="string">'DELL'</span>]))</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pdata</div></pre></td></tr></table></figure><pre><code>&lt;class &#39;pandas.core.panel.Panel&#39;&gt;
Dimensions: 4 (items) x 1820 (major_axis) x 6 (minor_axis)
Items axis: AAPL to MSFT
Major_axis axis: 2010-01-04 00:00:00 to 2017-02-27 00:00:00
Minor_axis axis: Open to Adj Close
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pdata = pdata.swapaxes(<span class="string">'items'</span>, <span class="string">'minor'</span>)</div><div class="line">pdata[<span class="string">'Adj Close'</span>].iloc[:<span class="number">10</span>]</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>AAPL</th><th>DELL</th><th>GOOG</th><th>MSFT</th></tr><tr><th>Date</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>2010-01-04</th><td>27.727039</td><td>14.06528</td><td>313.062468</td><td>25.555485</td></tr><tr><th>2010-01-05</th><td>27.774976</td><td>14.38450</td><td>311.683844</td><td>25.563741</td></tr><tr><th>2010-01-06</th><td>27.333178</td><td>14.10397</td><td>303.826685</td><td>25.406859</td></tr><tr><th>2010-01-07</th><td>27.282650</td><td>14.23940</td><td>296.753749</td><td>25.142634</td></tr><tr><th>2010-01-08</th><td>27.464034</td><td>14.36516</td><td>300.709808</td><td>25.316031</td></tr><tr><th>2010-01-11</th><td>27.221758</td><td>14.37483</td><td>300.255255</td><td>24.994007</td></tr><tr><th>2010-01-12</th><td>26.912110</td><td>14.56830</td><td>294.945572</td><td>24.828866</td></tr><tr><th>2010-01-13</th><td>27.291720</td><td>14.57797</td><td>293.252243</td><td>25.060064</td></tr><tr><th>2010-01-14</th><td>27.133657</td><td>14.22005</td><td>294.630868</td><td>25.563741</td></tr><tr><th>2010-01-15</th><td>26.680198</td><td>13.92985</td><td>289.710772</td><td>25.481172</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pdata.ix[:, <span class="string">'6/1/2012'</span>, :]</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Open</th><th>High</th><th>Low</th><th>Close</th><th>Volume</th><th>Adj Close</th></tr></thead><tbody><tr><th>AAPL</th><td>569.159996</td><td>572.650009</td><td>560.520012</td><td>560.989983</td><td>130246900.0</td><td>72.681610</td></tr><tr><th>DELL</th><td>12.150000</td><td>12.300000</td><td>12.045000</td><td>12.070000</td><td>19397600.0</td><td>11.675920</td></tr><tr><th>GOOG</th><td>571.790972</td><td>572.650996</td><td>568.350996</td><td>570.981000</td><td>6138700.0</td><td>285.205295</td></tr><tr><th>MSFT</th><td>28.760000</td><td>28.959999</td><td>28.440001</td><td>28.450001</td><td>56634300.0</td><td>24.942239</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pdata.ix[<span class="string">'Adj Close'</span>, <span class="string">'5/22/2012'</span>:, :].iloc[:<span class="number">10</span>]</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>AAPL</th><th>DELL</th><th>GOOG</th><th>MSFT</th></tr><tr><th>Date</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>2012-05-22</th><td>72.160786</td><td>14.58765</td><td>300.100412</td><td>26.090721</td></tr><tr><th>2012-05-23</th><td>73.921494</td><td>12.08221</td><td>304.426106</td><td>25.520864</td></tr><tr><th>2012-05-24</th><td>73.242607</td><td>12.04351</td><td>301.528978</td><td>25.485795</td></tr><tr><th>2012-05-25</th><td>72.850038</td><td>12.05319</td><td>295.470050</td><td>25.477028</td></tr><tr><th>2012-05-28</th><td>NaN</td><td>12.05319</td><td>NaN</td><td>NaN</td></tr><tr><th>2012-05-29</th><td>74.143041</td><td>12.24666</td><td>296.873645</td><td>25.915380</td></tr><tr><th>2012-05-30</th><td>75.037005</td><td>12.14992</td><td>293.821674</td><td>25.722505</td></tr><tr><th>2012-05-31</th><td>74.850442</td><td>11.92743</td><td>290.140354</td><td>25.591000</td></tr><tr><th>2012-06-01</th><td>72.681610</td><td>11.67592</td><td>285.205295</td><td>24.942239</td></tr><tr><th>2012-06-04</th><td>73.109156</td><td>11.60821</td><td>289.006480</td><td>25.029908</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">stacked = pdata.ix[:, <span class="string">'5/30/2012'</span>:, :].to_frame()</div><div class="line">stacked</div></pre></td></tr></table></figure><div><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th></th><th>Open</th><th>High</th><th>Low</th><th>Close</th><th>Volume</th><th>Adj Close</th></tr><tr><th>Date</th><th>minor</th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th rowspan="4" valign="top">2012-05-30</th><th>AAPL</th><td>569.199997</td><td>579.989990</td><td>566.559990</td><td>579.169998</td><td>132357400.0</td><td>75.037005</td></tr><tr><th>DELL</th><td>12.590000</td><td>12.700000</td><td>12.460000</td><td>12.560000</td><td>19787800.0</td><td>12.149920</td></tr><tr><th>GOOG</th><td>588.161028</td><td>591.901014</td><td>583.530999</td><td>588.230992</td><td>3827600.0</td><td>293.821674</td></tr><tr><th>MSFT</th><td>29.350000</td><td>29.480000</td><td>29.120001</td><td>29.340000</td><td>41585500.0</td><td>25.722505</td></tr><tr><th rowspan="4" valign="top">2012-05-31</th><th>AAPL</th><td>580.740021</td><td>581.499985</td><td>571.460022</td><td>577.730019</td><td>122918600.0</td><td>74.850442</td></tr><tr><th>DELL</th><td>12.530000</td><td>12.540000</td><td>12.330000</td><td>12.330000</td><td>19955600.0</td><td>11.927430</td></tr><tr><th>GOOG</th><td>588.720982</td><td>590.001032</td><td>579.001013</td><td>580.860990</td><td>5958800.0</td><td>290.140354</td></tr><tr><th>MSFT</th><td>29.299999</td><td>29.420000</td><td>28.940001</td><td>29.190001</td><td>39134000.0</td><td>25.591000</td></tr><tr><th rowspan="4" valign="top">2012-06-01</th><th>AAPL</th><td>569.159996</td><td>572.650009</td><td>560.520012</td><td>560.989983</td><td>130246900.0</td><td>72.681610</td></tr><tr><th>DELL</th><td>12.150000</td><td>12.300000</td><td>12.045000</td><td>12.070000</td><td>19397600.0</td><td>11.675920</td></tr><tr><th>GOOG</th><td>571.790972</td><td>572.650996</td><td>568.350996</td><td>570.981000</td><td>6138700.0</td><td>285.205295</td></tr><tr><th>MSFT</th><td>28.760000</td><td>28.959999</td><td>28.440001</td><td>28.450001</td><td>56634300.0</td><td>24.942239</td></tr><tr><th rowspan="4" valign="top">2012-06-04</th><th>AAPL</th><td>561.500008</td><td>567.499985</td><td>548.499977</td><td>564.289978</td><td>139248900.0</td><td>73.109156</td></tr><tr><th>DELL</th><td>12.110000</td><td>12.112500</td><td>11.800000</td><td>12.000000</td><td>17015700.0</td><td>11.608210</td></tr><tr><th>GOOG</th><td>570.220958</td><td>580.491016</td><td>570.011006</td><td>578.590973</td><td>4883500.0</td><td>289.006480</td></tr><tr><th>MSFT</th><td>28.620001</td><td>28.780001</td><td>28.320000</td><td>28.549999</td><td>47926300.0</td><td>25.029908</td></tr><tr><th rowspan="4" valign="top">2012-06-05</th><th>AAPL</th><td>561.269989</td><td>566.470001</td><td>558.330002</td><td>562.830025</td><td>97053600.0</td><td>72.920005</td></tr><tr><th>DELL</th><td>11.950000</td><td>12.240000</td><td>11.950000</td><td>12.160000</td><td>15620900.0</td><td>11.762980</td></tr><tr><th>GOOG</th><td>575.451008</td><td>578.131003</td><td>566.470986</td><td>570.410999</td><td>4697200.0</td><td>284.920579</td></tr><tr><th>MSFT</th><td>28.510000</td><td>28.750000</td><td>28.389999</td><td>28.510000</td><td>45715400.0</td><td>24.994841</td></tr><tr><th rowspan="4" valign="top">2012-06-06</th><th>AAPL</th><td>567.770004</td><td>573.849983</td><td>565.499992</td><td>571.460022</td><td>100363900.0</td><td>74.038104</td></tr><tr><th>DELL</th><td>12.210000</td><td>12.280000</td><td>12.090000</td><td>12.215000</td><td>20779900.0</td><td>11.816190</td></tr><tr><th>GOOG</th><td>576.480979</td><td>581.970971</td><td>573.611004</td><td>580.570966</td><td>4207200.0</td><td>289.995487</td></tr><tr><th>MSFT</th><td>28.879999</td><td>29.370001</td><td>28.809999</td><td>29.350000</td><td>46860500.0</td><td>25.731273</td></tr><tr><th rowspan="4" valign="top">2012-06-07</th><th>AAPL</th><td>577.290009</td><td>577.320023</td><td>570.500000</td><td>571.720001</td><td>94941700.0</td><td>74.071787</td></tr><tr><th>DELL</th><td>12.320000</td><td>12.410000</td><td>12.120000</td><td>12.130000</td><td>20074000.0</td><td>11.733960</td></tr><tr><th>GOOG</th><td>587.601014</td><td>587.891038</td><td>577.251006</td><td>578.230986</td><td>3530100.0</td><td>288.826666</td></tr><tr><th>MSFT</th><td>29.639999</td><td>29.700001</td><td>29.170000</td><td>29.230000</td><td>37792800.0</td><td>25.626067</td></tr><tr><th rowspan="2" valign="top">2012-06-08</th><th>AAPL</th><td>571.599998</td><td>580.580017</td><td>568.999992</td><td>580.319984</td><td>86879100.0</td><td>75.185997</td></tr><tr><th>DELL</th><td>12.130000</td><td>12.225000</td><td>12.020000</td><td>12.120000</td><td>18155600.0</td><td>11.724290</td></tr><tr><th>...</th><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th rowspan="3" valign="top">2017-02-13</th><th>AAPL</th><td>133.080002</td><td>133.820007</td><td>132.750000</td><td>133.289993</td><td>23035400.0</td><td>133.289993</td></tr><tr><th>GOOG</th><td>816.000000</td><td>820.958984</td><td>815.489990</td><td>819.239990</td><td>1198100.0</td><td>819.239990</td></tr><tr><th>MSFT</th><td>64.239998</td><td>64.860001</td><td>64.129997</td><td>64.720001</td><td>22920100.0</td><td>64.330000</td></tr><tr><th rowspan="3" valign="top">2017-02-14</th><th>AAPL</th><td>133.470001</td><td>135.089996</td><td>133.250000</td><td>135.020004</td><td>32815500.0</td><td>135.020004</td></tr><tr><th>GOOG</th><td>819.000000</td><td>823.000000</td><td>816.000000</td><td>820.450012</td><td>1053600.0</td><td>820.450012</td></tr><tr><th>MSFT</th><td>64.410004</td><td>64.720001</td><td>64.019997</td><td>64.570000</td><td>23065900.0</td><td>64.570000</td></tr><tr><th rowspan="3" valign="top">2017-02-15</th><th>AAPL</th><td>135.520004</td><td>136.270004</td><td>134.619995</td><td>135.509995</td><td>35501600.0</td><td>135.509995</td></tr><tr><th>GOOG</th><td>819.359985</td><td>823.000000</td><td>818.469971</td><td>818.979980</td><td>1304000.0</td><td>818.979980</td></tr><tr><th>MSFT</th><td>64.500000</td><td>64.570000</td><td>64.160004</td><td>64.529999</td><td>16917000.0</td><td>64.529999</td></tr><tr><th rowspan="3" valign="top">2017-02-16</th><th>AAPL</th><td>135.669998</td><td>135.899994</td><td>134.839996</td><td>135.350006</td><td>22118000.0</td><td>135.350006</td></tr><tr><th>GOOG</th><td>819.929993</td><td>824.400024</td><td>818.979980</td><td>824.159973</td><td>1281700.0</td><td>824.159973</td></tr><tr><th>MSFT</th><td>64.739998</td><td>65.239998</td><td>64.440002</td><td>64.519997</td><td>20524700.0</td><td>64.519997</td></tr><tr><th rowspan="3" valign="top">2017-02-17</th><th>AAPL</th><td>135.100006</td><td>135.830002</td><td>135.100006</td><td>135.720001</td><td>22084500.0</td><td>135.720001</td></tr><tr><th>GOOG</th><td>823.020020</td><td>828.070007</td><td>821.655029</td><td>828.070007</td><td>1597800.0</td><td>828.070007</td></tr><tr><th>MSFT</th><td>64.470001</td><td>64.690002</td><td>64.300003</td><td>64.620003</td><td>21234600.0</td><td>64.620003</td></tr><tr><th rowspan="3" valign="top">2017-02-21</th><th>AAPL</th><td>136.229996</td><td>136.750000</td><td>135.979996</td><td>136.699997</td><td>24265100.0</td><td>136.699997</td></tr><tr><th>GOOG</th><td>828.659973</td><td>833.450012</td><td>828.349976</td><td>831.659973</td><td>1247700.0</td><td>831.659973</td></tr><tr><th>MSFT</th><td>64.610001</td><td>64.949997</td><td>64.449997</td><td>64.489998</td><td>19384900.0</td><td>64.489998</td></tr><tr><th rowspan="3" valign="top">2017-02-22</th><th>AAPL</th><td>136.429993</td><td>137.119995</td><td>136.110001</td><td>137.110001</td><td>20745300.0</td><td>137.110001</td></tr><tr><th>GOOG</th><td>828.659973</td><td>833.250000</td><td>828.640015</td><td>830.760010</td><td>982900.0</td><td>830.760010</td></tr><tr><th>MSFT</th><td>64.330002</td><td>64.389999</td><td>64.050003</td><td>64.360001</td><td>19259700.0</td><td>64.360001</td></tr><tr><th rowspan="3" valign="top">2017-02-23</th><th>AAPL</th><td>137.380005</td><td>137.479996</td><td>136.300003</td><td>136.529999</td><td>20704100.0</td><td>136.529999</td></tr><tr><th>GOOG</th><td>830.119995</td><td>832.460022</td><td>822.880005</td><td>831.330017</td><td>1470100.0</td><td>831.330017</td></tr><tr><th>MSFT</th><td>64.419998</td><td>64.730003</td><td>64.190002</td><td>64.620003</td><td>20235200.0</td><td>64.620003</td></tr><tr><th rowspan="3" valign="top">2017-02-24</th><th>AAPL</th><td>135.910004</td><td>136.660004</td><td>135.279999</td><td>136.660004</td><td>21690900.0</td><td>136.660004</td></tr><tr><th>GOOG</th><td>827.729980</td><td>829.000000</td><td>824.200012</td><td>828.640015</td><td>1386600.0</td><td>828.640015</td></tr><tr><th>MSFT</th><td>64.529999</td><td>64.800003</td><td>64.139999</td><td>64.620003</td><td>21705200.0</td><td>64.620003</td></tr><tr><th rowspan="3" valign="top">2017-02-27</th><th>AAPL</th><td>137.139999</td><td>137.440002</td><td>136.279999</td><td>136.929993</td><td>20196400.0</td><td>136.929993</td></tr><tr><th>GOOG</th><td>824.549988</td><td>830.500000</td><td>824.000000</td><td>829.280029</td><td>1099500.0</td><td>829.280029</td></tr><tr><th>MSFT</th><td>64.540001</td><td>64.540001</td><td>64.050003</td><td>64.230003</td><td>15850400.0</td><td>64.230003</td></tr></tbody></table><p>3952 rows × 6 columns</p></div><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">stacked.to_panel()</div></pre></td></tr></table></figure><pre><code>&lt;class &#39;pandas.core.panel.Panel&#39;&gt;
Dimensions: 6 (items) x 1207 (major_axis) x 4 (minor_axis)
Items axis: Open to Adj Close
Major_axis axis: 2012-05-30 00:00:00 to 2017-02-27 00:00:00
Minor_axis axis: AAPL to MSFT
</code></pre></div><div></div><div></div><footer class="post-footer"><div class="post-eof"></div></footer></article></section><nav class="pagination"><a class="extend prev" rel="prev" href="/page/13/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><span class="page-number current">14</span><a class="page-number" href="/page/15/">15</a><span class="space">&hellip;</span><a class="page-number" href="/page/26/">26</a><a class="extend next" rel="next" href="/page/15/"><i class="fa fa-angle-right"></i></a></nav></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><section class="site-overview sidebar-panel sidebar-panel-active"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="Ewan Li"><p class="site-author-name" itemprop="name">Ewan Li</p><p class="site-description motion-element" itemprop="description">Ewan's IT Blog</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives"><span class="site-state-item-count">26</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-tags"><a href="/tags"><span class="site-state-item-count">16</span> <span class="site-state-item-name">tags</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/ewanlee" target="_blank" title="Github"><i class="fa fa-fw fa-globe"></i> Github </a></span><span class="links-of-author-item"><a href="http://weibo.com/3946248928/profile?topnav=1&wvr=6" target="_blank" title="Weibo"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2017</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Ewan Li</span></div><div class="powered-by">Powered by <a class="theme-link" href="https://hexo.io">Hexo</a></div><div class="theme-info">Theme - <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a></div><div class="busuanzi-count"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv"><i class="fa fa-user">本站访客数</i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span>人次</span> <span class="site-pv"><i class="fa fa-eye">本站总访问量</i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span>次</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script><script type="text/javascript">var duoshuoQuery={short_name:"ewanlee"};!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.id="duoshuo-script",t.src=("https:"==document.location.protocol?"https:":"http:")+"//static.duoshuo.com/embed.js",t.charset="UTF-8",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(t)}()</script><script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script><script src="/js/src/hook-duoshuo.js"></script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="popoverlay">').css("overflow","hidden"),$(".popup").toggle()}var isfetched=!1,search_path="search.xml";0==search_path.length&&(search_path="search.xml");var path="/"+search_path,searchFunc=function(e,t,a){"use strict";$.ajax({url:e,dataType:"xml",async:!0,success:function(e){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var r=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),c=document.getElementById(t),n=document.getElementById(a);c.addEventListener("input",function(){var e=0,t='<ul class="search-result-list">',a=this.value.trim().toLowerCase().split(/[\s\-]+/);n.innerHTML="",this.value.trim().length>1&&r.forEach(function(r){var c=!1,n=r.title.trim().toLowerCase(),s=r.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),o=decodeURIComponent(r.url),i=-1,l=-1,p=-1;if(""!=n&&a.forEach(function(e,t){i=n.indexOf(e),l=s.indexOf(e),(i>=0||l>=0)&&(c=!0,0==t&&(p=l))}),c){e+=1,t+="<li><a href='"+o+"' class='search-result-title'>"+n+"</a>";var h=r.content.trim().replace(/<[^>]+>/g,"");if(p>=0){var u=p-20,d=p+80;u<0&&(u=0),0==u&&(d=50),d>h.length&&(d=h.length);var f=h.substring(u,d);a.forEach(function(e){var t=new RegExp(e,"gi");f=f.replace(t,'<b class="search-keyword">'+e+"</b>")}),t+='<p class="search-result">'+f+"...</p>"}t+="</li>"}}),t+="</ul>",0==e&&(t='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'),""==a&&(t='<div id="no-result"><i class="fa fa-search fa-5x" /></div>'),n.innerHTML=t}),proceedsearch()}})};$(".popup-trigger").click(function(e){e.stopPropagation(),0==isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(function(e){$(".popup").hide(),$(".popoverlay").remove(),$("body").css("overflow","")}),$(".popup").click(function(e){e.stopPropagation()})</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });</script><script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("e27VKX5tTklQLCtF7iNMmhcA-gzGzoHsz","nnQn2znNgXXEdK7W2bVJ3bfK")</script><script>function showTime(e){var t=new AV.Query(e),n=[],o=$(".leancloud_visitors");o.each(function(){n.push($(this).attr("id").trim())}),t.containedIn("url",n),t.find().done(function(e){var t=".leancloud-visitors-count";if(0===e.length)return void o.find(t).text(0);for(var i=0;i<e.length;i++){var r=e[i],s=r.get("url"),l=r.get("time"),c=document.getElementById(s);$(c).find(t).text(l)}for(var i=0;i<n.length;i++){var s=n[i],c=document.getElementById(s),u=$(c).find(t);""==u.text()&&u.text(0)}}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(e){var t=$(".leancloud_visitors"),n=t.attr("id").trim(),o=t.attr("data-flag-title").trim(),i=new AV.Query(e);i.equalTo("url",n),i.find({success:function(t){if(t.length>0){var i=t[0];i.fetchWhenSave(!0),i.increment("time"),i.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var r=new e,s=new AV.ACL;s.setPublicReadAccess(!0),s.setPublicWriteAccess(!0),r.setACL(s),r.set("title",o),r.set("url",n),r.set("time",1),r.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):$(".post-title-link").length>1&&showTime(e)})</script></body></html>